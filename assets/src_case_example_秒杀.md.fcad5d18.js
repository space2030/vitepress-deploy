import{_ as s,o as a,c as l,a as e}from"./app.2a154df8.js";const D=JSON.parse('{"title":"\u79D2\u6740","description":"","frontmatter":{},"headers":[{"level":2,"title":"01 \u5982\u4F55\u5904\u7406\u8D85\u5356\u95EE\u9898","slug":"_01-\u5982\u4F55\u5904\u7406\u8D85\u5356\u95EE\u9898"},{"level":2,"title":"02 \u5982\u4F55\u89E3\u51B3\u91CD\u590D\u4E0B\u5355\u95EE\u9898","slug":"_02-\u5982\u4F55\u89E3\u51B3\u91CD\u590D\u4E0B\u5355\u95EE\u9898"},{"level":2,"title":"03 \u70ED\u70B9\u6570\u636E\u5931\u6548\uFF08\u7F13\u5B58\u51FB\u7A7F\uFF09\u95EE\u9898\u5982\u4F55\u89E3\u51B3","slug":"_03-\u70ED\u70B9\u6570\u636E\u5931\u6548\uFF08\u7F13\u5B58\u51FB\u7A7F\uFF09\u95EE\u9898\u5982\u4F55\u89E3\u51B3"},{"level":2,"title":"04 \u7F13\u5B58\u548C\u6570\u636E\u5E93\u6570\u636E\u4E00\u81F4\u6027\u5982\u4F55\u4FDD\u8BC1","slug":"_04-\u7F13\u5B58\u548C\u6570\u636E\u5E93\u6570\u636E\u4E00\u81F4\u6027\u5982\u4F55\u4FDD\u8BC1"},{"level":2,"title":"05 \u51CF\u5E93\u5B58\u6210\u529F\u4E86\uFF0C\u4F46\u662F\u751F\u6210\u8BA2\u5355\u5931\u8D25\u4E86\uFF0C\u600E\u4E48\u5904\u7406","slug":"_05-\u51CF\u5E93\u5B58\u6210\u529F\u4E86\uFF0C\u4F46\u662F\u751F\u6210\u8BA2\u5355\u5931\u8D25\u4E86\uFF0C\u600E\u4E48\u5904\u7406"},{"level":2,"title":"06 \u9650\u6D41\u524A\u5CF0\u7684\u63AA\u65BD","slug":"_06-\u9650\u6D41\u524A\u5CF0\u7684\u63AA\u65BD"},{"level":2,"title":"07 \u5BA2\u6237\u6076\u610F\u4E0B\u5355\u95EE\u9898","slug":"_07-\u5BA2\u6237\u6076\u610F\u4E0B\u5355\u95EE\u9898"},{"level":2,"title":"08 \u591A\u673A\u5668\u6263\u51CF\u5E93\u5B58\uFF0C\u5982\u4F55\u4FDD\u8BC1\u5B83\u7684\u7EBF\u7A0B\u5B89\u5168","slug":"_08-\u591A\u673A\u5668\u6263\u51CF\u5E93\u5B58\uFF0C\u5982\u4F55\u4FDD\u8BC1\u5B83\u7684\u7EBF\u7A0B\u5B89\u5168"},{"level":2,"title":"09 \u5982\u4F55\u53BB\u51CFRedis\u4E2D\u7684\u5E93\u5B58","slug":"_09-\u5982\u4F55\u53BB\u51CFredis\u4E2D\u7684\u5E93\u5B58"},{"level":2,"title":"10 \u7F13\u5B58\u4E2D\u7684\u6570\u636E\u7A81\u7136\u5931\u6548\uFF0C\u5BFC\u81F4\u8BF7\u6C42\u5168\u90E8\u6253\u5230\u4E86\u6570\u636E\u5E93\uFF0C\u5982\u4F55\u89E3\u51B3","slug":"_10-\u7F13\u5B58\u4E2D\u7684\u6570\u636E\u7A81\u7136\u5931\u6548\uFF0C\u5BFC\u81F4\u8BF7\u6C42\u5168\u90E8\u6253\u5230\u4E86\u6570\u636E\u5E93\uFF0C\u5982\u4F55\u89E3\u51B3"},{"level":2,"title":"11 \u5982\u679C\u9879\u76EE\u4E2D\u7684Redis\u6302\u6389\uFF0C\u5982\u4F55\u51CF\u8F7B\u6570\u636E\u5E93\u7684\u538B\u529B","slug":"_11-\u5982\u679C\u9879\u76EE\u4E2D\u7684redis\u6302\u6389\uFF0C\u5982\u4F55\u51CF\u8F7B\u6570\u636E\u5E93\u7684\u538B\u529B"},{"level":2,"title":"12 \u9875\u9762\u9759\u6001\u5316","slug":"_12-\u9875\u9762\u9759\u6001\u5316"},{"level":2,"title":"13 \u79D2\u6740\u7CFB\u7EDF\u9762\u4E34\u7684\u95EE\u9898","slug":"_13-\u79D2\u6740\u7CFB\u7EDF\u9762\u4E34\u7684\u95EE\u9898"},{"level":2,"title":"14 \u79D2\u6740\u7CFB\u7EDF\u8BBE\u8BA1","slug":"_14-\u79D2\u6740\u7CFB\u7EDF\u8BBE\u8BA1"},{"level":2,"title":"15 \u5206\u5E03\u5F0F\u4F1A\u8BDD","slug":"_15-\u5206\u5E03\u5F0F\u4F1A\u8BDD"},{"level":2,"title":"16 \u7EBF\u7A0B\u6C60\u7684\u6267\u884C\u8FC7\u7A0B","slug":"_16-\u7EBF\u7A0B\u6C60\u7684\u6267\u884C\u8FC7\u7A0B"},{"level":2,"title":"17 \u9879\u76EE\u96BE\u70B9","slug":"_17-\u9879\u76EE\u96BE\u70B9"},{"level":2,"title":"18 \u603B\u7ED3","slug":"_18-\u603B\u7ED3"},{"level":3,"title":"\u9879\u76EE\u4E2Dredis\u505A\u4E86\u4EC0\u4E48","slug":"\u9879\u76EE\u4E2Dredis\u505A\u4E86\u4EC0\u4E48"},{"level":3,"title":"\u9879\u76EE\u4E2DActiveMQ\u90FD\u505A\u4E86\u4EC0\u4E48","slug":"\u9879\u76EE\u4E2Dactivemq\u90FD\u505A\u4E86\u4EC0\u4E48"},{"level":3,"title":"\u7EBF\u7A0B\u6C60\u6280\u672F\u4E2D\u6838\u5FC3\u7EBF\u7A0B\u6570\u7684\u53D6\u503C\u6709\u7ECF\u9A8C\u503C\u5417","slug":"\u7EBF\u7A0B\u6C60\u6280\u672F\u4E2D\u6838\u5FC3\u7EBF\u7A0B\u6570\u7684\u53D6\u503C\u6709\u7ECF\u9A8C\u503C\u5417"},{"level":3,"title":"TPS\u63D0\u5347\u4E86\u591A\u5C11","slug":"tps\u63D0\u5347\u4E86\u591A\u5C11"},{"level":3,"title":"nginx\u7684\u8D1F\u8F7D\u5747\u8861\u7B56\u7565","slug":"nginx\u7684\u8D1F\u8F7D\u5747\u8861\u7B56\u7565"},{"level":3,"title":"\u4E00\u4E2A\u4EBA\u540C\u65F6\u7528\u7535\u8111\u548C\u624B\u673A\u53BB\u62A2\u8D2D\u5546\u54C1\uFF0C\u4F1A\u9881\u53D1\u51E0\u4E2Atoken","slug":"\u4E00\u4E2A\u4EBA\u540C\u65F6\u7528\u7535\u8111\u548C\u624B\u673A\u53BB\u62A2\u8D2D\u5546\u54C1\uFF0C\u4F1A\u9881\u53D1\u51E0\u4E2Atoken"},{"level":3,"title":"\u5982\u4F55\u5229\u7528\u7EBF\u7A0B\u6C60\u5B9E\u73B0\u6D41\u91CF\u524A\u5CF0","slug":"\u5982\u4F55\u5229\u7528\u7EBF\u7A0B\u6C60\u5B9E\u73B0\u6D41\u91CF\u524A\u5CF0"},{"level":3,"title":"\u7EBF\u7A0B\u6C60\u7684\u62D2\u7EDD\u7B56\u7565","slug":"\u7EBF\u7A0B\u6C60\u7684\u62D2\u7EDD\u7B56\u7565"},{"level":3,"title":"\u88AB\u7EBF\u7A0B\u6C60\u62D2\u7EDD\u6389\u7684\u90A3\u90E8\u5206\u7528\u6237\u7684\u79D2\u6740\u4EE4\u724C\u8FD8\u6709\u6548\u5417","slug":"\u88AB\u7EBF\u7A0B\u6C60\u62D2\u7EDD\u6389\u7684\u90A3\u90E8\u5206\u7528\u6237\u7684\u79D2\u6740\u4EE4\u724C\u8FD8\u6709\u6548\u5417"},{"level":3,"title":"\u7EBF\u7A0B\u6C60\u4E2D\u963B\u585E\u961F\u5217\u7684\u5927\u5C0F\u8BBE\u7F6E\u4E3A\u591A\u5C11\u5408\u9002","slug":"\u7EBF\u7A0B\u6C60\u4E2D\u963B\u585E\u961F\u5217\u7684\u5927\u5C0F\u8BBE\u7F6E\u4E3A\u591A\u5C11\u5408\u9002"},{"level":3,"title":"\u79D2\u6740\u4EE4\u724C\uFF08token\uFF09\u6BCF\u79D2\u949F\u751F\u6210\u591A\u5C11\u4E2A","slug":"\u79D2\u6740\u4EE4\u724C\uFF08token\uFF09\u6BCF\u79D2\u949F\u751F\u6210\u591A\u5C11\u4E2A"},{"level":3,"title":"\u80FD\u4E0D\u80FD\u8BE6\u7EC6\u63CF\u8FF0\u4E00\u4E0B\u4F7F\u7528MQ\u5F02\u6B65\u51CFredis\u4E0EMySQL\u5E93\u5B58\u7684\u8FC7\u7A0B","slug":"\u80FD\u4E0D\u80FD\u8BE6\u7EC6\u63CF\u8FF0\u4E00\u4E0B\u4F7F\u7528mq\u5F02\u6B65\u51CFredis\u4E0Emysql\u5E93\u5B58\u7684\u8FC7\u7A0B"},{"level":3,"title":"\u505A\u5230\u4E86\u4EC0\u4E48\u7A0B\u5EA6\uFF0C\u5E93\u5B58\u91CF\u4E0E\u5E76\u53D1\u5EA6\u662F\u591A\u5C11","slug":"\u505A\u5230\u4E86\u4EC0\u4E48\u7A0B\u5EA6\uFF0C\u5E93\u5B58\u91CF\u4E0E\u5E76\u53D1\u5EA6\u662F\u591A\u5C11"},{"level":3,"title":"MySQL\u4E2D\u7684\u8868\u662F\u600E\u4E48\u8BBE\u8BA1\u7684","slug":"mysql\u4E2D\u7684\u8868\u662F\u600E\u4E48\u8BBE\u8BA1\u7684"},{"level":3,"title":"\u5982\u4F55\u53EA\u4F7F\u7528MySQL\u4FDD\u8BC1\u5546\u54C1\u6CA1\u6709\u8D85\u5356","slug":"\u5982\u4F55\u53EA\u4F7F\u7528mysql\u4FDD\u8BC1\u5546\u54C1\u6CA1\u6709\u8D85\u5356"},{"level":3,"title":"\u6570\u636E\u5E93\u6539\u5E93\u5B58\u7684SQL","slug":"\u6570\u636E\u5E93\u6539\u5E93\u5B58\u7684sql"},{"level":3,"title":"\u5982\u4F55\u9632\u6B62\u7528\u6237\u4E00\u76F4\u70B9\u51FB\u4E0B\u5355\u6309\u94AE","slug":"\u5982\u4F55\u9632\u6B62\u7528\u6237\u4E00\u76F4\u70B9\u51FB\u4E0B\u5355\u6309\u94AE"}],"relativePath":"src/case/example/\u79D2\u6740.md","lastUpdated":1697524142000}'),n={name:"src/case/example/\u79D2\u6740.md"},p=e(`<h1 id="\u79D2\u6740" tabindex="-1">\u79D2\u6740 <a class="header-anchor" href="#\u79D2\u6740" aria-hidden="true">#</a></h1><h2 id="_01-\u5982\u4F55\u5904\u7406\u8D85\u5356\u95EE\u9898" tabindex="-1">01 \u5982\u4F55\u5904\u7406\u8D85\u5356\u95EE\u9898 <a class="header-anchor" href="#_01-\u5982\u4F55\u5904\u7406\u8D85\u5356\u95EE\u9898" aria-hidden="true">#</a></h2><p>\u76F4\u63A5\u7531\u6570\u636E\u5E93\u64CD\u4F5C\u5E93\u5B58\u7684sql\u8BED\u53E5\u5982\u4E0B\u6240\u793A\u3002\u4F9D\u9760mysql\u4E2D\u6392\u4ED6\u9501\u5B9E\u73B0</p><div class="language-text"><span class="copy"></span><pre><code><span class="line"><span style="color:#c9d1d9;">update table_prmo set num = num -1 where id = 1001 and num &gt; 0</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">\u5229\u7528redis\u7684\u5355\u7EBF\u7A0B\u7279\u6027\u9884\u51CF\u5E93\u5B58\u5904\u7406\u79D2\u6740\u8D85\u5356\u95EE\u9898</p><ol><li>\u5728\u7CFB\u7EDF\u521D\u59CB\u5316\u65F6\uFF0C\u5C06\u5546\u54C1\u4EE5\u53CA\u5BF9\u5E94\u7684\u5E93\u5B58\u6570\u91CF\u9884\u5148\u52A0\u8F7D\u5230redis\u7F13\u5B58\u4E2D\uFF08\u7F13\u5B58\u9884\u70ED\uFF09</li><li>\u63A5\u6536\u5230\u79D2\u6740\u8BF7\u6C42\u65F6\uFF0C\u5728redis\u4E2D\u8FDB\u884C\u9884\u51CF\u5E93\u5B58\uFF08decrement\uFF09,\u5F53redis\u4E2D\u7684\u5E93\u5B58\u4E0D\u8DB3\u65F6\uFF0C\u76F4\u63A5\u8FD4\u56DE\u79D2\u6740\u5931\u8D25\uFF0C\u5426\u5219\u7EE7\u7EED\u8FDB\u884C\u7B2C3\u6B65\uFF1B</li><li>\u5C06\u8BF7\u6C42\u653E\u5165\u5F02\u6B65\u961F\u5217\u4E2D\uFF0C\u8FD4\u56DE\u6B63\u5728\u6392\u961F\u4E2D\uFF1B</li><li>\u670D\u52A1\u7AEF\u5F02\u6B65\u961F\u5217\uFF08MQ\uFF09\u5C06\u8BF7\u6C42\u51FA\u961F\uFF0C\u51FA\u961F\u6210\u529F\u7684\u8BF7\u6C42\u53EF\u4EE5\u751F\u6210\u79D2\u6740\u8BA2\u5355\uFF0C\u51CF\u5C11\u6570\u636E\u5E93\u5E93\u5B58\uFF0C\u8FD4\u56DE\u79D2\u6740\u8BA2\u5355\u8BE6\u60C5\u3002</li></ol></div><h2 id="_02-\u5982\u4F55\u89E3\u51B3\u91CD\u590D\u4E0B\u5355\u95EE\u9898" tabindex="-1">02 \u5982\u4F55\u89E3\u51B3\u91CD\u590D\u4E0B\u5355\u95EE\u9898 <a class="header-anchor" href="#_02-\u5982\u4F55\u89E3\u51B3\u91CD\u590D\u4E0B\u5355\u95EE\u9898" aria-hidden="true">#</a></h2><p>mysql\u552F\u4E00\u7D22\u5F15\uFF08\u5546\u54C1\u7D22\u5F15\uFF09 + \u5206\u5E03\u5F0F\u9501</p><h2 id="_03-\u70ED\u70B9\u6570\u636E\u5931\u6548\uFF08\u7F13\u5B58\u51FB\u7A7F\uFF09\u95EE\u9898\u5982\u4F55\u89E3\u51B3" tabindex="-1">03 \u70ED\u70B9\u6570\u636E\u5931\u6548\uFF08\u7F13\u5B58\u51FB\u7A7F\uFF09\u95EE\u9898\u5982\u4F55\u89E3\u51B3 <a class="header-anchor" href="#_03-\u70ED\u70B9\u6570\u636E\u5931\u6548\uFF08\u7F13\u5B58\u51FB\u7A7F\uFF09\u95EE\u9898\u5982\u4F55\u89E3\u51B3" aria-hidden="true">#</a></h2><p>\u8BBE\u7F6E\u70ED\u70B9\u6570\u636E\u6C38\u4E0D\u8FC7\u671F</p><div class="language-shell"><span class="copy"></span><pre><code><span class="line"></span>
<span class="line"><span style="color:#8B949E;"># QPS \u4E00\u79D2\u5185\u53EF\u4EE5\u5904\u7406\u7684\u8BF7\u6C42\u6570\u91CF</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">\u5047\u8BBE\u4E00\u4E2A\u670D\u52A1\u7684 RT(Response time) \u662F 20ms\uFF0C\u5219 QPS \u4E3A 50\uFF08\u5355\u673A\uFF09</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><ul><li>\u5E76\u53D1\u95EE\u9898</li></ul><div class="danger custom-block"><p class="custom-block-title">\u60B2\u89C2\u9501</p><div class="language-shell"><span class="copy"></span><pre><code><span class="line"><span style="color:#8B949E;"># \u60B2\u89C2\u9501</span></span>
<span class="line"><span style="color:#FF7B72;">select</span><span style="color:#C9D1D9;"> * from stock where product_id = xxx </span><span style="color:#FF7B72;">for</span><span style="color:#C9D1D9;"> update</span><span style="color:#FF7B72;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">update stock </span><span style="color:#79C0FF;">set</span><span style="color:#C9D1D9;"> count = count - 1 where product_id = xxx and count </span><span style="color:#FF7B72;">&gt;</span><span style="color:#C9D1D9;"> 0 </span><span style="color:#FF7B72;">;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div></div><div class="tip custom-block"><p class="custom-block-title">\u4E50\u89C2\u9501</p><div class="language-shell"><span class="copy"></span><pre><code><span class="line"><span style="color:#C9D1D9;">update </span></span>
<span class="line"><span style="color:#C9D1D9;">stock </span></span>
<span class="line"><span style="color:#79C0FF;">set</span><span style="color:#C9D1D9;"> count = count - 1 and version = version + 1 </span></span>
<span class="line"><span style="color:#C9D1D9;">where product_id = xxx and count </span><span style="color:#FF7B72;">&gt;</span><span style="color:#C9D1D9;"> 0  and version = xxx</span></span>
<span class="line"></span></code></pre></div></div><ul><li>\u79D2\u6740\u5012\u8BA1\u65F6</li></ul><ol><li>\u524D\u7AEF\u9875\u9762\u7B2C\u4E00\u6B21\u4ECE\u670D\u52A1\u7AEF\u83B7\u53D6\u6D3B\u52A8\u5F00\u59CB\u65F6\u95F4\uFF0C\u670D\u52A1\u7AEF\u5F53\u524D\u65F6\u95F4\uFF0C\u7136\u540E\uFF0C\u5728\u5BA2\u6237\u7AEF\u8BA1\u7B97\u5012\u8BA1\u65F6</li><li>\u6700\u540E\u63D0\u4EA4\u8BA2\u5355\u65F6\uFF0C\u670D\u52A1\u7AEF\u518D\u6B21\u6821\u9A8C\u5BA2\u6237\u7AEF\u548C\u670D\u52A1\u7AEF\u5F53\u524D\u65F6\u95F4\u3002</li></ol><ul><li><p>\u4E0B\u5355\u51CF\u5E93\u5B58\u6216\u8005\u652F\u4ED8\u51CF\u5E93\u5B58 \u4E0B\u5355\u9501\u5B9A\u5E93\u5B58\uFF0C\u652F\u4ED8\u51CF\u5E93\u5B58</p></li><li><p>\u9632\u6B62\u8D85\u5356</p></li></ul><p>\u628A\u5E93\u5B58\u6570\u636E\u653E\u5165\u5230\u7F13\u5B58\u4E2D\uFF0C\u5229\u7528\u7F13\u5B58\u7684\u539F\u5B50\u7279\u6027\u4FDD\u8BC1\u540C\u65F6\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u64CD\u4F5C\u5E93\u5B58</p><ul><li>\u5E93\u5B58\u5199\u56DE\u6570\u636E\u5E93\u7684\u65F6\u673A</li></ul><p>\u5B9A\u65F6\u4EFB\u52A1\u540C\u6B65 redis \u7684\u6570\u636E\u5199\u56DE\u6570\u636E\u5E93</p><ul><li><p>\u5237\u7206\u9875\u9762\u5982\u4F55\u5904\u7406 \u628A\u9875\u9762\u505A\u9759\u6001\u5316\u5904\u7406\uFF0C\u9875\u9762\u653E\u5728\u9759\u6001\u670D\u52A1\u5668 \uFF08CDN\uFF09</p></li><li><p>\u5927\u91CF\u8BF7\u6C42\uFF0C\u722C\u866B\u95EE\u9898</p></li></ul><p>\u589E\u52A0\u9875\u9762\u8BBF\u95EE\u9A8C\u8BC1\u7801\u3001\u589E\u52A0 IP \u9ED1\u540D\u5355</p><ul><li>\u79D2\u6740\u670D\u52A1\u5668\u6302\u4E86\uFF0C\u5982\u4F55\u4E0D\u5F71\u54CD\u6B63\u5E38\u8D2D\u4E70</li></ul><p>\u91C7\u7528\u7194\u65AD\u7684\u65B9\u5F0F</p><div class="tip custom-block"><p class="custom-block-title">\u7194\u65AD</p><ol><li>\u7194\u65AD\u662F\u6307\u8D85\u8FC7\u4E86\u67D0\u4E2A\u4FDD\u62A4\u9608\u503C\u60C5\u51B5\u4E0B\uFF0C\u7CFB\u7EDF\u505A\u51FA\u7684\u4FDD\u62A4\u63AA\u65BD</li><li>\u7194\u65AD\u5F80\u5F80\u6307\u67D0\u4E2A\u670D\u52A1\u8D85\u8FC7\u4E86\u65E2\u5B9A\u538B\u529B\u9608\u503C\u60C5\u51B5\u4E0B\u505A\u5230\u7684 <strong>\u5FEB\u901F\u5931\u8D25</strong> \u5904\u7406</li></ol></div><ul><li>\u77ED\u65F6\u95F4\u9891\u7E41\u8C03\u7528\u63A5\u53E3\u4E0B\u5355</li></ul><p>\u91C7\u7528\u9650\u6D41\u5668</p><ul><li>\u975E\u8D2D\u7269\u5173\u952E\u8DEF\u5F84\u670D\u52A1\u964D\u7EA7</li></ul><p>\u67E5\u770B\u8BC4\u8BBA\u3001\u6BCF\u4E00\u9875\u8BC4\u8BBA\u6570/\u5386\u53F2\u8BA2\u5355\u6570</p><ul><li>\u79D2\u6740\u7CFB\u7EDF\u548C\u8BA2\u7968\u7CFB\u7EDF\u7684\u4E3B\u8981\u5DEE\u5F02 <strong>\u5E93\u5B58\u7EF4\u5EA6\u7684\u5DEE\u5F02</strong></li></ul><h2 id="_04-\u7F13\u5B58\u548C\u6570\u636E\u5E93\u6570\u636E\u4E00\u81F4\u6027\u5982\u4F55\u4FDD\u8BC1" tabindex="-1">04 \u7F13\u5B58\u548C\u6570\u636E\u5E93\u6570\u636E\u4E00\u81F4\u6027\u5982\u4F55\u4FDD\u8BC1 <a class="header-anchor" href="#_04-\u7F13\u5B58\u548C\u6570\u636E\u5E93\u6570\u636E\u4E00\u81F4\u6027\u5982\u4F55\u4FDD\u8BC1" aria-hidden="true">#</a></h2><ul><li>\u4F7F\u7528canal\u7EC4\u4EF6\u5B9E\u73B0\uFF08canal\u7684\u539F\u7406\uFF0C\u6A21\u62DFmysql\u7684\u4E3B\u4ECE\u590D\u5236\u673A\u5236\uFF09</li><li>\u66F4\u65B0\u6570\u636E\u5E93\u540E\u7ACB\u5373\u5220\u7F13\u5B58\uFF0C\u7136\u540E\u4E0B\u4E00\u6B21\u67E5\u7F13\u5B58\u627E\u4E0D\u5230\u6570\u636E\u540E\u4F1A\u518D\u6B21\u4ECE\u6570\u636E\u5E93\u540C\u6B65\u5230\u7F13\u5B58</li></ul><h2 id="_05-\u51CF\u5E93\u5B58\u6210\u529F\u4E86\uFF0C\u4F46\u662F\u751F\u6210\u8BA2\u5355\u5931\u8D25\u4E86\uFF0C\u600E\u4E48\u5904\u7406" tabindex="-1">05 \u51CF\u5E93\u5B58\u6210\u529F\u4E86\uFF0C\u4F46\u662F\u751F\u6210\u8BA2\u5355\u5931\u8D25\u4E86\uFF0C\u600E\u4E48\u5904\u7406 <a class="header-anchor" href="#_05-\u51CF\u5E93\u5B58\u6210\u529F\u4E86\uFF0C\u4F46\u662F\u751F\u6210\u8BA2\u5355\u5931\u8D25\u4E86\uFF0C\u600E\u4E48\u5904\u7406" aria-hidden="true">#</a></h2><ol><li><p>\u975E\u5206\u5E03\u5F0F\u7684\u7CFB\u7EDF\u4E2D\u4F7F\u7528Spring\u63D0\u4F9B\u4E8B\u52A1\u529F\u80FD\u5373\u53EF</p></li><li><p>\u5206\u5E03\u5F0F\u4E8B\u52A1\uFF1A\u5C06\u51CF\u5E93\u5B58\u4E0E\u751F\u6210\u8BA2\u5355\u64CD\u4F5C\u7EC4\u5408\u4E3A\u4E00\u4E2A\u4E8B\u52A1\uFF0C\u8981\u4E48\u4E00\u8D77\u6210\u529F\uFF0C\u8981\u4E48\u4E00\u8D77\u5931\u8D25\u3002</p></li></ol><div class="tip custom-block"><p class="custom-block-title">CPA\u7406\u8BBA\uFF08\u53EA\u80FD\u4FDD\u8BC1CP\u3001AP\uFF09\u3001BASE\u7406\u8BBA\uFF08\u6700\u7EC8\u4E00\u81F4\u6027\uFF0C\u57FA\u672C\u53EF\u7528\u6027\uFF0C\u67D4\u6027\u4E8B\u52A1\uFF09</p><p>\u5206\u5E03\u5F0F\u4E8B\u52A1\u7684\u4E24\u4E2A\u534F\u8BAE\u4EE5\u53CA\u51E0\u79CD\u89E3\u51B3\u65B9\u6848</p><ul><li>\u5168\u5C40\u6D88\u606F</li><li>\u57FA\u4E8E\u53EF\u9760\u6D88\u606F\uFF08MQ\uFF09\u7684\u5206\u5E03\u5F0F\u4E8B\u52A1</li><li>TCC</li><li>\u6700\u5927\u52AA\u529B\u901A\u77E5</li><li>seata\u5206\u5E03\u5F0F\u4E8B\u52A1\u63A7\u5236\u7EC4\u4EF6</li></ul></div><h2 id="_06-\u9650\u6D41\u524A\u5CF0\u7684\u63AA\u65BD" tabindex="-1">06 \u9650\u6D41\u524A\u5CF0\u7684\u63AA\u65BD <a class="header-anchor" href="#_06-\u9650\u6D41\u524A\u5CF0\u7684\u63AA\u65BD" aria-hidden="true">#</a></h2><p>\u79D2\u6740\u4EE4\u724C\uFF08token\uFF09\u52A0\u79D2\u6740\u5927\u95F8\u9650\u5236\u5165\u53E3\u6D41\u91CF\uFF0C\u7EBF\u7A0B\u6C60\u6280\u672F\u9650\u5236\u77AC\u65F6\u5E76\u53D1\u6570\uFF0C\u9A8C\u8BC1\u7801\u505A\u9632\u5237\u529F\u80FD\u3002</p><h2 id="_07-\u5BA2\u6237\u6076\u610F\u4E0B\u5355\u95EE\u9898" tabindex="-1">07 \u5BA2\u6237\u6076\u610F\u4E0B\u5355\u95EE\u9898 <a class="header-anchor" href="#_07-\u5BA2\u6237\u6076\u610F\u4E0B\u5355\u95EE\u9898" aria-hidden="true">#</a></h2><p>\u5C01IP\uFF0Cnginx\u4E2D\u6709\u4E00\u4E2A\u8BBE\u7F6E\uFF0C\u5355\u4E2AIP\u8BBF\u95EE\u9891\u7387\u548C\u6B21\u6570\u591A\u4E86\u4E4B\u540E\u6709\u4E00\u4E2A\u62C9\u9ED1\u64CD\u4F5C\u3002</p><h2 id="_08-\u591A\u673A\u5668\u6263\u51CF\u5E93\u5B58\uFF0C\u5982\u4F55\u4FDD\u8BC1\u5B83\u7684\u7EBF\u7A0B\u5B89\u5168" tabindex="-1">08 \u591A\u673A\u5668\u6263\u51CF\u5E93\u5B58\uFF0C\u5982\u4F55\u4FDD\u8BC1\u5B83\u7684\u7EBF\u7A0B\u5B89\u5168 <a class="header-anchor" href="#_08-\u591A\u673A\u5668\u6263\u51CF\u5E93\u5B58\uFF0C\u5982\u4F55\u4FDD\u8BC1\u5B83\u7684\u7EBF\u7A0B\u5B89\u5168" aria-hidden="true">#</a></h2><p>\u5206\u5E03\u5F0F\u9501\u3002redission\u5BA2\u6237\u7AEF\u5B9E\u73B0\u5206\u5E03\u5F0F\u9501\u3002</p><h2 id="_09-\u5982\u4F55\u53BB\u51CFredis\u4E2D\u7684\u5E93\u5B58" tabindex="-1">09 \u5982\u4F55\u53BB\u51CFRedis\u4E2D\u7684\u5E93\u5B58 <a class="header-anchor" href="#_09-\u5982\u4F55\u53BB\u51CFredis\u4E2D\u7684\u5E93\u5B58" aria-hidden="true">#</a></h2><p>decrement API\u51CF\u5E93\u5B58\uFF0Cincrement API\u589E\u5E93\u5B58\uFF0C\u4EE5\u4E0A\u7684\u6307\u4EE4\u90FD\u662F\u539F\u5B50\u6027\u7684\u3002</p><h2 id="_10-\u7F13\u5B58\u4E2D\u7684\u6570\u636E\u7A81\u7136\u5931\u6548\uFF0C\u5BFC\u81F4\u8BF7\u6C42\u5168\u90E8\u6253\u5230\u4E86\u6570\u636E\u5E93\uFF0C\u5982\u4F55\u89E3\u51B3" tabindex="-1">10 \u7F13\u5B58\u4E2D\u7684\u6570\u636E\u7A81\u7136\u5931\u6548\uFF0C\u5BFC\u81F4\u8BF7\u6C42\u5168\u90E8\u6253\u5230\u4E86\u6570\u636E\u5E93\uFF0C\u5982\u4F55\u89E3\u51B3 <a class="header-anchor" href="#_10-\u7F13\u5B58\u4E2D\u7684\u6570\u636E\u7A81\u7136\u5931\u6548\uFF0C\u5BFC\u81F4\u8BF7\u6C42\u5168\u90E8\u6253\u5230\u4E86\u6570\u636E\u5E93\uFF0C\u5982\u4F55\u89E3\u51B3" aria-hidden="true">#</a></h2><p>\u5178\u578B\u7684\u7F13\u5B58\u96EA\u5D29\u95EE\u9898\uFF0C\u7ED9\u7F13\u5B58\u4E2D\u7684\u6570\u636E\u7684\u8FC7\u671F\u65F6\u95F4\u52A0\u968F\u673A\u6570</p><h2 id="_11-\u5982\u679C\u9879\u76EE\u4E2D\u7684redis\u6302\u6389\uFF0C\u5982\u4F55\u51CF\u8F7B\u6570\u636E\u5E93\u7684\u538B\u529B" tabindex="-1">11 \u5982\u679C\u9879\u76EE\u4E2D\u7684Redis\u6302\u6389\uFF0C\u5982\u4F55\u51CF\u8F7B\u6570\u636E\u5E93\u7684\u538B\u529B <a class="header-anchor" href="#_11-\u5982\u679C\u9879\u76EE\u4E2D\u7684redis\u6302\u6389\uFF0C\u5982\u4F55\u51CF\u8F7B\u6570\u636E\u5E93\u7684\u538B\u529B" aria-hidden="true">#</a></h2><p>redis\u96C6\u7FA4\uFF0C\u4E3B\u4ECE\u6A21\u5F0F\u3001\u54E8\u5175\u6A21\u5F0F\u3001\u96C6\u7FA4\u6A21\u5F0F</p><div class="tip custom-block"><p class="custom-block-title">\u4E3B\u4ECE\u6A21\u5F0F\uFF1A</p><p>\u5982\u679C\u4E3B\u673A\u5B95\u673A\uFF0C\u4F7F\u7528slave of no one\u65AD\u5F00\u4E3B\u4ECE\u5173\u7CFB\u628A\u4ECE\u673A\u5347\u7EA7\u4E3A\u4E3B\u673A</p></div><div class="tip custom-block"><p class="custom-block-title">\u54E8\u5175\u6A21\u5F0F\uFF1A</p><ol><li>\u81EA\u52A8\u76D1\u63A7master / slave\u7684\u8FD0\u884C\u72B6\u6001\uFF0C\u57FA\u672C\u539F\u7406\uFF1A\u5FC3\u8DF3\u673A\u5236+\u6295\u7968\u88C1\u51B3\u3002 \u6BCF\u4E2Asentinel\u4F1A\u5411\u5176\u5B83sentinel\u3001master\u3001slave\u5B9A\u65F6\u53D1\u9001\u6D88\u606F\u3002</li><li>\u54E8\u5175\u5B9A\u671F\u7ED9\u4E3B\u6216\u8005\u4ECE\u548Cslave\u53D1\u9001ping\u5305\uFF08IP\uFF1Aport\uFF09\uFF0C\u6B63\u5E38\u5219\u54CD\u5E94pong\uFF0Cping\u548Cpong\u5C31\u53EB\u5FC3\u8DF3\u673A\u5236\uFF0C <ul><li>\u4EE5\u786E\u8BA4\u5BF9\u65B9\u662F\u5426\u201C\u6D3B\u7740\u201D\uFF0C\u5982\u679C\u53D1\u73B0\u5BF9\u65B9\u5728\u6307\u5B9A\u65F6\u95F4\uFF08\u53EF\u914D\u7F6E\uFF09\u5185\u672A\u56DE\u5E94\uFF0C</li><li>\u5219\u6682\u65F6\u8BA4\u4E3A\u5BF9\u65B9\u5DF2\u6302\uFF08\u6240\u8C13\u7684\u201C\u4E3B\u89C2\u8BA4\u4E3A\u5B95\u673A\u201DSubjective Down\uFF0C\u7B80\u79F0SDOWN\uFF09\u3002</li><li>\u82E5master\u88AB\u5224\u65AD\u6B7B\u4EA1\u4E4B\u540E\uFF0C\u901A\u8FC7\u9009\u4E3E\u7B97\u6CD5\uFF0C\u4ECE\u5269\u4E0B\u7684slave\u8282\u70B9\u4E2D\u9009\u4E00\u53F0\u5347\u7EA7\u4E3Amaster\u3002\u5E76\u81EA\u52A8\u4FEE\u6539\u76F8\u5173\u914D\u7F6E\u3002</li></ul></li></ol></div><h2 id="_12-\u9875\u9762\u9759\u6001\u5316" tabindex="-1">12 \u9875\u9762\u9759\u6001\u5316 <a class="header-anchor" href="#_12-\u9875\u9762\u9759\u6001\u5316" aria-hidden="true">#</a></h2><p>\u628A\u80FD\u63D0\u524D\u653E\u5165cdn\u670D\u52A1\u5668\u7684\u4E1C\u897F\u90FD\u653E\u8FDB\u53BB\uFF0C\u53CD\u6B63\u628A\u6240\u6709\u80FD\u63D0\u5347\u6548\u7387\u7684\u6B65\u9AA4\u90FD\u505A\u4E00\u4E0B\uFF0C\u51CF\u5C11\u771F\u6B63\u79D2\u6740\u65F6\u5019\u670D\u52A1\u5668\u7684\u538B\u529B\u3002</p><h2 id="_13-\u79D2\u6740\u7CFB\u7EDF\u9762\u4E34\u7684\u95EE\u9898" tabindex="-1">13 \u79D2\u6740\u7CFB\u7EDF\u9762\u4E34\u7684\u95EE\u9898 <a class="header-anchor" href="#_13-\u79D2\u6740\u7CFB\u7EDF\u9762\u4E34\u7684\u95EE\u9898" aria-hidden="true">#</a></h2><ul><li>\u9AD8\u5E76\u53D1</li><li>\u8D85\u5356\u3001\u91CD\u590D\u5356\u95EE\u9898</li><li>\u811A\u672C\u6076\u610F\u8BF7\u6C42</li><li>\u6570\u636E\u5E93\u625B\u4E0D\u4F4F</li><li>\u52A0\u4E86\u7F13\u5B58\u4E4B\u540E\u7684\u7F13\u5B58\u4E09\u5927\u95EE\u9898\uFF08\u51FB\u7A7F\u3001\u7A7F\u900F\u3001\u96EA\u5D29\uFF09</li></ul><h2 id="_14-\u79D2\u6740\u7CFB\u7EDF\u8BBE\u8BA1" tabindex="-1">14 \u79D2\u6740\u7CFB\u7EDF\u8BBE\u8BA1 <a class="header-anchor" href="#_14-\u79D2\u6740\u7CFB\u7EDF\u8BBE\u8BA1" aria-hidden="true">#</a></h2><ol start="19"><li>nginx\u505A\u4E00\u4E2A\u52A8\u9759\u5206\u79BB\u4EE5\u53CA\u8D1F\u8F7D\u5747\u8861</li><li>redis\u7F13\u5B58\u9884\u70ED\u3001\u9884\u51CF\u5E93\u5B58</li><li>MQ\u5F02\u6B65\u4E0B\u5355</li></ol><h2 id="_15-\u5206\u5E03\u5F0F\u4F1A\u8BDD" tabindex="-1">15 \u5206\u5E03\u5F0F\u4F1A\u8BDD <a class="header-anchor" href="#_15-\u5206\u5E03\u5F0F\u4F1A\u8BDD" aria-hidden="true">#</a></h2><blockquote><p>token + redis\u89E3\u51B3\u5206\u5E03\u5F0F\u4F1A\u8BDD\u95EE\u9898</p></blockquote><p>Token\u662F\u670D\u52A1\u7AEF\u751F\u6210\u7684\u4E00\u4E32\u5B57\u7B26\u4E32\uFF0C\u4F5C\u4E3A\u5BA2\u6237\u7AEF\u8FDB\u884C\u8BF7\u6C42\u7684\u4E00\u4E2A\u4EE4\u724C\uFF0C\u5F53\u7B2C\u4E00\u6B21\u767B\u5F55\u540E\uFF0C\u670D\u52A1\u5668\u751F\u6210\u4E00\u4E2AuserToken\uFF0C\u4FBF\u5C06\u6B64Token\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF\uFF0C\u5B58\u5165cookie\u4E2D\u4FDD\u5B58\uFF0C\u4EE5\u540E\u5BA2\u6237\u7AEF\u53EA\u9700\u5E26\u4E0A\u8FD9\u4E2AuserToken\u524D\u6765\u8BF7\u6C42\u6570\u636E\u5373\u53EF\uFF0C\u65E0\u9700\u518D\u6B21\u5E26\u4E0A\u7528\u6237\u540D\u548C\u5BC6\u7801\u3002\u4E8C\u6B21\u767B\u5F55\u65F6\uFF0C\u53EA\u9700\u8981\u53BBredis\u4E2D\u83B7\u53D6\u5BF9\u5E94token\u7684value\u9A8C\u8BC1\u7528\u6237\u5F62\u8C61\u5373\u53EF</p><div class="language-text"><span class="copy"></span><pre><code><span class="line"><span style="color:#c9d1d9;">// \u7528\u6237\u7B2C\u4E00\u6B21\u767B\u5F55\u65F6\uFF0C\u7ECF\u8FC7\u76F8\u5173\u4FE1\u606F\u7684\u9A8C\u8BC1\u540E\u5C06\u5BF9\u5E94\u7684\u767B\u5F55\u4FE1\u606F\u4EE5\u53CA\u51ED\u8BC1\uFF08token\uFF09\u5B58\u5165redis\u4E2D</span></span>
<span class="line"><span style="color:#c9d1d9;">String uuid = UUID.rondom().toString();</span></span>
<span class="line"><span style="color:#c9d1d9;">redisTemplate.opsForValue().set(uuid, userModel);</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span>
<span class="line"><span style="color:#c9d1d9;">// token\u4E0B\u53D1\u5230\u5BA2\u6237\u7AEF\u5B58\u5165cookie\u4E2D\u8FDB\u884C\u4FDD\u5B58</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span>
<span class="line"><span style="color:#c9d1d9;">// \u518D\u6B21\u767B\u5F55\u65F6cookie\u643A\u5E26\u7740token\u5230redis\u4E2D\u627E\u5230\u5BF9\u5E94\u7684value\u4E0D\u4E3A\u7A7A\uFF0C\u8868\u793A\u8BE5\u7528\u6237\u5DF2\u7ECF\u767B\u9646\u8FC7\u4E86\uFF0C\u5982\u679C\u67E5\u8BE2\u7ED3\u679C\u4E3A\u7A7A\uFF0C</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span>
<span class="line"><span style="color:#c9d1d9;">// \u5219\u8BA9\u8BE5\u7528\u6237\u91CD\u65B0\u767B\u9646\uFF0C\u7136\u540E\u5C06\u7528\u6237\u4FE1\u606F\u4FDD\u5B58\u5230redis\u4E2D\u3002</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span>
<span class="line"><span style="color:#c9d1d9;">// \u4E00\u822C\u8BBE\u7F6E\u4E00\u4E2A\u8FC7\u671F\u65F6\u95F4\uFF0C\u8868\u793A\u7684\u5C31\u662F\u591A\u4E45\u540E\u7528\u6237\u7684\u767B\u5F55\u6001\u5C31\u5931\u6548\u4E86</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span></code></pre></div><h2 id="_16-\u7EBF\u7A0B\u6C60\u7684\u6267\u884C\u8FC7\u7A0B" tabindex="-1">16 \u7EBF\u7A0B\u6C60\u7684\u6267\u884C\u8FC7\u7A0B <a class="header-anchor" href="#_16-\u7EBF\u7A0B\u6C60\u7684\u6267\u884C\u8FC7\u7A0B" aria-hidden="true">#</a></h2><p>\u6838\u5FC3\u53C2\u6570\uFF1A</p><ul><li>corePoolSize\uFF1A\u7EBF\u7A0B\u6C60\u6838\u5FC3\u7EBF\u7A0B\u6570\u6700\u5927\u503C</li><li>maximumPoolSize\uFF1A\u7EBF\u7A0B\u6C60\u6700\u5927\u7EBF\u7A0B\u6570\u5927\u5C0F</li><li>keepAliveTime\uFF1A\u7EBF\u7A0B\u6C60\u4E2D\u975E\u6838\u5FC3\u7EBF\u7A0B\u7A7A\u95F2\u7684\u5B58\u6D3B\u65F6\u95F4\u5927\u5C0F</li><li>unit\uFF1A\u7EBF\u7A0B\u7A7A\u95F2\u5B58\u6D3B\u65F6\u95F4\u7684\u5355\u4F4D</li><li>workQueue\uFF1A\u5B58\u653E\u4EFB\u52A1\u7684\u963B\u585E\u961F\u5217</li><li>threadFactory\uFF1A\u7528\u4E8E\u8BBE\u7F6E\u521B\u5EFA\u7EBF\u7A0B\u7684\u5DE5\u5382\uFF0C\u53EF\u4EE5\u7ED9\u521B\u5EFA\u7684\u7EBF\u7A0B\u8BBE\u7F6E\u6709\u610F\u4E49\u7684\u540D\u5B57\uFF0C\u53EF\u65B9\u4FBF\u6392\u67E5\u95EE\u9898</li><li>handler\uFF1A\u7EBF\u7A0B\u6C60\u7684\u9971\u548C\u7B56\u7565\u4E8B\u4EF6\uFF0C\u4E3B\u8981\u6709\u56DB\u79CD\u7C7B\u578B</li></ul><div class="tip custom-block"><p class="custom-block-title">\u6267\u884C\u8FC7\u7A0B\uFF1A</p><p>\u4E00\u4E2A\u4EFB\u52A1\u8FDB\u6765\uFF0C\u5148\u5224\u65AD\u5F53\u524D\u7EBF\u7A0B\u6C60\u4E2D\u7684\u6838\u5FC3\u7EBF\u7A0B\u6570\u662F\u5426\u5C0F\u4E8EcorePoolSize\u3002\u5C0F\u4E8E\u7684\u8BDD\u4F1A\u76F4\u63A5\u521B\u5EFA\u4E00\u4E2A\u6838\u5FC3\u7EBF\u7A0B\u53BB\u63D0\u4EA4\u4E1A\u52A1\uFF0C\u5982\u679C\u6838\u5FC3\u7EBF\u7A0B\u6570\u8FBE\u5230\u9650\u5236\uFF0C\u90A3\u4E48\u63A5\u4E0B\u6765\u7684\u4EFB\u52A1\u4F1A\u88AB\u653E\u5165\u963B\u585E\u961F\u5217\u4E2D\u6392\u961F\u7B49\u5F85\u6267\u884C\u3002 \u5F53\u6838\u5FC3\u7EBF\u7A0B\u6570\u8FBE\u5230\u9650\u5236\u4E14\u963B\u585E\u961F\u5217\u5DF2\u6EE1\uFF0C\u5F00\u59CB\u521B\u5EFA\u975E\u6838\u5FC3\u7EBF\u7A0B\u6765\u6267\u884C\u963B\u585E\u961F\u5217\u4E2D\u7684\u4E1A\u52A1\uFF0C\u5F53\u7EBF\u7A0B\u6570\u8FBE\u5230\u4E86maximumPoolSize\u4E14\u963B\u585E\u961F\u5217\u5DF2\u6EE1\u3002\u90A3\u4E48\u4F1A\u91C7\u7528\u62D2\u7EDD\u7B56\u7565\u5904\u7406\u540E\u6765\u7684\u4E1A\u52A1\u3002</p></div><h2 id="_17-\u9879\u76EE\u96BE\u70B9" tabindex="-1">17 \u9879\u76EE\u96BE\u70B9 <a class="header-anchor" href="#_17-\u9879\u76EE\u96BE\u70B9" aria-hidden="true">#</a></h2><p>\u9650\u6D41\u3001\u524A\u5CF0\u90E8\u5206\u7684\u8BBE\u8BA1 \u7528\u6237\u7684\u767B\u5F55\u7684\u95EE\u9898\uFF08\u5206\u5E03\u5F0F\u4F1A\u8BDD\uFF09</p><div class="tip custom-block"><p class="custom-block-title">\u5165\u53E3\u5927\u6D41\u91CF\u9650\u5236</p><ul><li>\u4F8B\u5982\u670910w\u7528\u6237\u6765\u62A210\u4EF6\u5546\u54C1\uFF0C\u6211\u4EEC\u53EA\u653E100\u4E2A\u7528\u6237\u8FDB\u6765\u3002</li><li>\u91C7\u53D6\u53D1\u653E\u4EE4\u724C\u673A\u5236\uFF08\u63A7\u5236\u6D41\u91CF\uFF09\uFF0C\u6839\u636E\u5546\u54C1id\u548C\u4E00\u4E32uuid\u4EA7\u751F\u4E00\u4E2A\u4EE4\u724C\u5B58\u5165redis\u4E2D\u540C\u65F6\u5F15\u5165\u4E86\u79D2\u6740\u5927\u95F8\uFF0C\u76EE\u7684\u662F\u6D41\u91CF\u63A7\u5236\uFF0C\u6BD4\u5982\u5F53\u524D\u6D3B\u52A8\u5546\u54C1\u53EA\u6709100\u4EF6\uFF0C\u6211\u4EEC\u5C31\u53D1\u653E500\u4E2A\u4EE4\u724C\uFF0C\u79D2\u6740\u524D\u4F1A\u5148\u53D1\u653E\u4EE4\u724C\uFF0C\u4EE4\u724C\u53D1\u653E\u5B8C\u5219\u628A\u540E\u6765\u7684\u7528\u6237\u6321\u5728\u8FD9\u4E00\u5C42\u4E4B\u5916\uFF0C\u63A7\u5236\u4E86\u6D41\u91CF\u3002</li><li>\u83B7\u53D6\u4EE4\u724C\u540E\u4F1A\u5BF9\u6BD4redis\u4E2D\u7528\u6237\u4EA7\u751F\u7684\u4EE4\u724C\uFF0C\u5BF9\u6BD4\u6210\u529F\u624D\u53EF\u4EE5\u8D2D\u4E70\u5546\u54C1\u3002</li></ul><div class="language-java"><span class="copy"></span><pre><code><span class="line"><span style="color:#8B949E;">// \u8BBE\u7F6E\u79D2\u6740\u5927\u95F8</span></span>
<span class="line"><span style="color:#C9D1D9;">redisTemplate.</span><span style="color:#D2A8FF;">opsForValue</span><span style="color:#C9D1D9;">().</span><span style="color:#D2A8FF;">set</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;door_count&quot;</span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;">promoId, itemModel.</span><span style="color:#D2A8FF;">getStock</span><span style="color:#C9D1D9;">()</span><span style="color:#FF7B72;">*</span><span style="color:#79C0FF;">5</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#8B949E;">// \u53D1\u653E\u4EE4\u724C\u65F6\uFF0C\u5148\u53BBredis\u83B7\u53D6\u5F53\u524D\u5927\u95F8\u5269\u4F59\u4EE4\u724C\u6570</span></span>
<span class="line"><span style="color:#FF7B72;">int</span><span style="color:#FFA657;"> </span><span style="color:#C9D1D9;">dazha</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> redisTemplate.</span><span style="color:#D2A8FF;">opForValue</span><span style="color:#C9D1D9;">().</span><span style="color:#D2A8FF;">get</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;door_count&quot;</span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;">promoId);</span></span>
<span class="line"><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (dazha </span><span style="color:#FF7B72;">&lt;=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u629B\u51FA\u4E00\u4E2A\u5F02\u5E38</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">throw</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> exception;</span></span>
<span class="line"><span style="color:#C9D1D9;">} </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    String</span><span style="color:#FFA657;"> </span><span style="color:#C9D1D9;">token</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> UUIDUtils.</span><span style="color:#D2A8FF;">getUUID</span><span style="color:#C9D1D9;">() </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> promoId;</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u7528\u6237\u53EA\u6709\u62E5\u6709\u8FD9\u4E2Atoken\u624D\u6709\u8D44\u683C\u4E0B\u5355</span></span>
<span class="line"><span style="color:#C9D1D9;">    redisTemplate.</span><span style="color:#D2A8FF;">opsForValue</span><span style="color:#C9D1D9;">().</span><span style="color:#D2A8FF;">set</span><span style="color:#C9D1D9;">(userToken, token);</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre></div></div><div class="tip custom-block"><p class="custom-block-title">\u9AD8\u5E76\u53D1\u6D41\u91CF\u7684\u9650\u5236\uFF08\u6CC4\u6D2A\uFF09</p><p>\u5229\u7528\u7EBF\u7A0B\u6C60\u6280\u672F\uFF0C\u7EF4\u62A4\u4E00\u4E2A\u5177\u6709\u56FA\u5B9A\u7EBF\u7A0B\u6570\u7684\u7EBF\u7A0B\u6C60\u3002\u6BCF\u6B21\u53EA\u653E\u56FA\u5B9A\u591A\u7528\u6237\u8BBF\u95EE\u670D\u52A1\uFF0C\u5176\u5B83\u7528\u6237\u6392\u961F\u3002\u53E6\u5916\u4E00\u79CD\u5B9E\u73B0\u65B9\u5F0F\u5C31\u662FJUC\u5305\u4E2D\u7684\u4FE1\u53F7\u91CF\u673A\u5236\u3002\u53EF\u4EE5\u6709\u6548\u7684\u9650\u5236\u7EBF\u7A0B\u7684\u8FDB\u5165\u3002</p></div><div class="tip custom-block"><p class="custom-block-title">\u7528\u6237\u767B\u5F55\u95EE\u9898</p><p>\u505A\u5B8C\u5206\u5E03\u5F0F\u6269\u5C55\u4E4B\u540E\uFF0C\u53D1\u73B0\u6709\u65F6\u5019\u5DF2\u7ECF\u767B\u5F55\u8FC7\u4E86\u4F46\u662F\u7CFB\u7EDF\u4ECD\u7136\u4F1A\u63D0\u793A\u53BB\u767B\u5F55\uFF0C\u540E\u6765\u7ECF\u8FC7\u67E5\u8D44\u6599\u53D1\u73B0cookie\u548Csession\u7684\u95EE\u9898\uFF0C\u7136\u540E\u901A\u8FC7\u8BBE\u7F6Ecookie\u8DE8\u57DF\u5206\u4EAB\u4EE5\u53CA\u5229\u7528redis\u5B58\u50A8token\u4FE1\u606F\u5F97\u4EE5\u89E3\u51B3\u3002</p></div><h2 id="_18-\u603B\u7ED3" tabindex="-1">18 \u603B\u7ED3 <a class="header-anchor" href="#_18-\u603B\u7ED3" aria-hidden="true">#</a></h2><h3 id="\u9879\u76EE\u4E2Dredis\u505A\u4E86\u4EC0\u4E48" tabindex="-1">\u9879\u76EE\u4E2Dredis\u505A\u4E86\u4EC0\u4E48 <a class="header-anchor" href="#\u9879\u76EE\u4E2Dredis\u505A\u4E86\u4EC0\u4E48" aria-hidden="true">#</a></h3><ol><li>\u4F5C\u4E3A\u7F13\u5B58\u4E2D\u95F4\u4EF6\u63D0\u4F9B\u7CFB\u7EDF\u6027\u80FD</li><li>\u9884\u51CF\u5E93\u5B58\uFF0C\u9632\u6B62\u8D85\u5356\u529F\u80FD\u5B9E\u73B0</li><li>redis\u8BBE\u7F6E\u70ED\u70B9\u6570\u636E\u6C38\u4E0D\u8FC7\u671F</li></ol><h3 id="\u9879\u76EE\u4E2Dactivemq\u90FD\u505A\u4E86\u4EC0\u4E48" tabindex="-1">\u9879\u76EE\u4E2DActiveMQ\u90FD\u505A\u4E86\u4EC0\u4E48 <a class="header-anchor" href="#\u9879\u76EE\u4E2Dactivemq\u90FD\u505A\u4E86\u4EC0\u4E48" aria-hidden="true">#</a></h3><p>\u4F5C\u4E3A\u5F02\u6B65\u4E0B\u5355\u7684\u4E2D\u95F4\u4EF6\uFF0C\u5229\u7528\u961F\u5217\u6392\u961F\u4E0B\u5355\u7F13\u89E3\u6570\u636E\u5E93\u7684\u5E76\u53D1\u538B\u529B</p><h3 id="\u7EBF\u7A0B\u6C60\u6280\u672F\u4E2D\u6838\u5FC3\u7EBF\u7A0B\u6570\u7684\u53D6\u503C\u6709\u7ECF\u9A8C\u503C\u5417" tabindex="-1">\u7EBF\u7A0B\u6C60\u6280\u672F\u4E2D\u6838\u5FC3\u7EBF\u7A0B\u6570\u7684\u53D6\u503C\u6709\u7ECF\u9A8C\u503C\u5417 <a class="header-anchor" href="#\u7EBF\u7A0B\u6C60\u6280\u672F\u4E2D\u6838\u5FC3\u7EBF\u7A0B\u6570\u7684\u53D6\u503C\u6709\u7ECF\u9A8C\u503C\u5417" aria-hidden="true">#</a></h3><ul><li>CPU\u5BC6\u96C6\u578B\u4E1A\u52A1\uFF1AN+1</li><li>IO\u5BC6\u96C6\u578B\u4E1A\u52A1\uFF1A2N + 1</li></ul><h3 id="tps\u63D0\u5347\u4E86\u591A\u5C11" tabindex="-1">TPS\u63D0\u5347\u4E86\u591A\u5C11 <a class="header-anchor" href="#tps\u63D0\u5347\u4E86\u591A\u5C11" aria-hidden="true">#</a></h3><p>\u57FA\u7840\u67B6\u6784\u4E0B\u7684tps\u662F200 \u7ECF\u8FC7\u505A\u52A8\u9759\u5206\u79BB\uFF0Cnginx\u53CD\u5411\u4EE3\u7406\u5E76\u505A\u4E86\u5206\u5E03\u5F0F\u6269\u5C55\uFF0C\u5F15\u5165redis\u4E2D\u95F4\u4EF6\u540E\u8FBE\u5230\u4E862500tps\u3002</p><h3 id="nginx\u7684\u8D1F\u8F7D\u5747\u8861\u7B56\u7565" tabindex="-1">nginx\u7684\u8D1F\u8F7D\u5747\u8861\u7B56\u7565 <a class="header-anchor" href="#nginx\u7684\u8D1F\u8F7D\u5747\u8861\u7B56\u7565" aria-hidden="true">#</a></h3><p>\u8F6E\u8BE2\u3001\u6743\u91CD\u3001IP_hash\u3001\u6700\u5C11\u8FDE\u63A5</p><h3 id="\u4E00\u4E2A\u4EBA\u540C\u65F6\u7528\u7535\u8111\u548C\u624B\u673A\u53BB\u62A2\u8D2D\u5546\u54C1\uFF0C\u4F1A\u9881\u53D1\u51E0\u4E2Atoken" tabindex="-1">\u4E00\u4E2A\u4EBA\u540C\u65F6\u7528\u7535\u8111\u548C\u624B\u673A\u53BB\u62A2\u8D2D\u5546\u54C1\uFF0C\u4F1A\u9881\u53D1\u51E0\u4E2Atoken <a class="header-anchor" href="#\u4E00\u4E2A\u4EBA\u540C\u65F6\u7528\u7535\u8111\u548C\u624B\u673A\u53BB\u62A2\u8D2D\u5546\u54C1\uFF0C\u4F1A\u9881\u53D1\u51E0\u4E2Atoken" aria-hidden="true">#</a></h3><ul><li>\u9996\u5148\u591A\u53F0\u8BBE\u5907\u767B\u5F55\u5C5E\u4E8ESSO\u95EE\u9898\uFF0C\u7528\u6237\u767B\u5F55\u4E00\u7AEF\u4E4B\u540E\u53E6\u5916\u4E00\u7AEF\u53EF\u4EE5\u901A\u8FC7\u626B\u7801\u7B49\u5F62\u5F0F\u767B\u5F55\u3002\u867D\u7136\u7528\u6237\u767B\u5F55\u4E86\u591A\u53F0\u8BBE\u5907\uFF0C</li><li>\u4F46\u662F\u7528\u6237\u540D\u662F\u4E00\u6837\u7684\u3002\u4E3A\u7528\u6237\u529E\u7406\u7684token\u7684\u76F8\u540C\u7684\uFF0C\u6211\u4EEC\u4E3A\u4E86\u4E00\u4E2A\u7528\u6237\u53EA\u4F1A\u9881\u53D1\u4E00\u4E2Atoken\u3002</li></ul><h3 id="\u5982\u4F55\u5229\u7528\u7EBF\u7A0B\u6C60\u5B9E\u73B0\u6D41\u91CF\u524A\u5CF0" tabindex="-1">\u5982\u4F55\u5229\u7528\u7EBF\u7A0B\u6C60\u5B9E\u73B0\u6D41\u91CF\u524A\u5CF0 <a class="header-anchor" href="#\u5982\u4F55\u5229\u7528\u7EBF\u7A0B\u6C60\u5B9E\u73B0\u6D41\u91CF\u524A\u5CF0" aria-hidden="true">#</a></h3><p>\u8BBE\u7F6E\u6700\u5927\u7EBF\u7A0B\u6570\u6765\u9650\u5236\u9AD8\u5E76\u53D1\u6D41\u91CF</p><h3 id="\u7EBF\u7A0B\u6C60\u7684\u62D2\u7EDD\u7B56\u7565" tabindex="-1">\u7EBF\u7A0B\u6C60\u7684\u62D2\u7EDD\u7B56\u7565 <a class="header-anchor" href="#\u7EBF\u7A0B\u6C60\u7684\u62D2\u7EDD\u7B56\u7565" aria-hidden="true">#</a></h3><div class="language-text"><span class="copy"></span><pre><code><span class="line"><span style="color:#c9d1d9;">// \u4E22\u5F03\u4EFB\u52A1\u5E76\u629B\u51FARejectedExceutionException\u5F02\u5E38</span></span>
<span class="line"><span style="color:#c9d1d9;">ThreadPoolExecutor.AbortPolicy</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span>
<span class="line"><span style="color:#c9d1d9;">// \u4E22\u5F03\u4EFB\u52A1\uFF0C\u4F46\u662F\u4E0D\u629B\u51FA\u5F02\u5E38</span></span>
<span class="line"><span style="color:#c9d1d9;">DiscardPolicy</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span>
<span class="line"><span style="color:#c9d1d9;">// \u4E22\u5F03\u961F\u5217\u6700\u524D\u9762\u7684\u4EFB\u52A1\uFF0C\u7136\u540E\u91CD\u65B0\u63D0\u4EA4\u88AB\u62D2\u7EDD\u7684\u4EFB\u52A1</span></span>
<span class="line"><span style="color:#c9d1d9;">DiscardOldestPolicy</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span>
<span class="line"><span style="color:#c9d1d9;">// \u7531\u8C03\u7528\u7EBF\u7A0B\uFF08\u63D0\u4EA4\u4EFB\u52A1\u7684\u7EBF\u7A0B\uFF09\u5904\u7406\u8BE5\u4EFB\u52A1</span></span>
<span class="line"><span style="color:#c9d1d9;">CallerRunPolicy</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span></code></pre></div><h3 id="\u88AB\u7EBF\u7A0B\u6C60\u62D2\u7EDD\u6389\u7684\u90A3\u90E8\u5206\u7528\u6237\u7684\u79D2\u6740\u4EE4\u724C\u8FD8\u6709\u6548\u5417" tabindex="-1">\u88AB\u7EBF\u7A0B\u6C60\u62D2\u7EDD\u6389\u7684\u90A3\u90E8\u5206\u7528\u6237\u7684\u79D2\u6740\u4EE4\u724C\u8FD8\u6709\u6548\u5417 <a class="header-anchor" href="#\u88AB\u7EBF\u7A0B\u6C60\u62D2\u7EDD\u6389\u7684\u90A3\u90E8\u5206\u7528\u6237\u7684\u79D2\u6740\u4EE4\u724C\u8FD8\u6709\u6548\u5417" aria-hidden="true">#</a></h3><p>\u65E0\u6548\uFF0C\u4F1A\u4ECEredis\u4E2D\u5220\u9664</p><h3 id="\u7EBF\u7A0B\u6C60\u4E2D\u963B\u585E\u961F\u5217\u7684\u5927\u5C0F\u8BBE\u7F6E\u4E3A\u591A\u5C11\u5408\u9002" tabindex="-1">\u7EBF\u7A0B\u6C60\u4E2D\u963B\u585E\u961F\u5217\u7684\u5927\u5C0F\u8BBE\u7F6E\u4E3A\u591A\u5C11\u5408\u9002 <a class="header-anchor" href="#\u7EBF\u7A0B\u6C60\u4E2D\u963B\u585E\u961F\u5217\u7684\u5927\u5C0F\u8BBE\u7F6E\u4E3A\u591A\u5C11\u5408\u9002" aria-hidden="true">#</a></h3><p>\u8BBE\u7F6E\u4E3A\u79D2\u6740\u5546\u54C1\u7684\u4E2A\u6570\u51CF\u53BB\u6838\u5FC3\u7EBF\u7A0B\u6570\u6700\u5408\u9002</p><div class="language-shell"><span class="copy"></span><pre><code><span class="line"><span style="color:#8B949E;"># \u9879\u76EE\u4E0A\u7EBF\u4E4B\u540E\uFF0C\u60F3\u770BJVM\u7684GC\u60C5\u51B5\u5728Linux\u4E2D\u7528\u4EC0\u4E48\u547D\u4EE4</span></span>
<span class="line"><span style="color:#C9D1D9;">jstat -gc vmid count</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;"># \u8868\u793A\u5C0612538\u8FDB\u7A0B\u5BF9\u5E94\u7684Java\u8FDB\u7A0B\u7684GC\u60C5\u51B5\uFF0C\u6BCF5\u79D2\u6253\u5370\u4E00\u6B21</span></span>
<span class="line"><span style="color:#C9D1D9;">jstat -gc 12538 5000</span></span>
<span class="line"></span></code></pre></div><h3 id="\u79D2\u6740\u4EE4\u724C\uFF08token\uFF09\u6BCF\u79D2\u949F\u751F\u6210\u591A\u5C11\u4E2A" tabindex="-1">\u79D2\u6740\u4EE4\u724C\uFF08token\uFF09\u6BCF\u79D2\u949F\u751F\u6210\u591A\u5C11\u4E2A <a class="header-anchor" href="#\u79D2\u6740\u4EE4\u724C\uFF08token\uFF09\u6BCF\u79D2\u949F\u751F\u6210\u591A\u5C11\u4E2A" aria-hidden="true">#</a></h3><p>\u8DDF\u968F\u7528\u6237\u7684\u8BF7\u6C42\u4F1A\u52A8\u6001\u53D8\u5316\uFF0C\u4EE4\u724C\u6876\u673A\u5236\u53EF\u4EE5\u63A7\u5236\u6BCF\u79D2\u751F\u6210\u4EE4\u724C\u7684\u4E2A\u6570</p><h3 id="\u80FD\u4E0D\u80FD\u8BE6\u7EC6\u63CF\u8FF0\u4E00\u4E0B\u4F7F\u7528mq\u5F02\u6B65\u51CFredis\u4E0Emysql\u5E93\u5B58\u7684\u8FC7\u7A0B" tabindex="-1">\u80FD\u4E0D\u80FD\u8BE6\u7EC6\u63CF\u8FF0\u4E00\u4E0B\u4F7F\u7528MQ\u5F02\u6B65\u51CFredis\u4E0EMySQL\u5E93\u5B58\u7684\u8FC7\u7A0B <a class="header-anchor" href="#\u80FD\u4E0D\u80FD\u8BE6\u7EC6\u63CF\u8FF0\u4E00\u4E0B\u4F7F\u7528mq\u5F02\u6B65\u51CFredis\u4E0Emysql\u5E93\u5B58\u7684\u8FC7\u7A0B" aria-hidden="true">#</a></h3><p>redis\u4E2D\u5E93\u5B58\u51CF\u6210\u529F\u540E\uFF0C\u751F\u6210\u4E00\u6761\u6D88\u606F\u5305\u542B\u4E86\u5546\u54C1\u4FE1\u606F\u3001\u7528\u6237\u4FE1\u606F\u6D88\u606F\u7531MQ\u7684\u751F\u6210\u8005\u751F\u4EA7\uFF0C\u7ECF\u7531queue\u6A21\u5F0F\u53D1\u9001\u7ED9\u6D88\u8D39\u65B9\uFF0C\u5373\u8BA2\u5355\u751F\u6210\u7684\u4E1A\u52A1\u6A21\u5757\uFF0C\u5728\u8BE5\u6A21\u5757\u4F1A\u6D88\u8D39\u8FD9\u6761\u6D88\u606F\uFF0C\u6839\u636E\u5176\u4E2D\u7684\u4FE1\u606F\u8FDB\u884C\u8BA2\u5355\u7684\u751F\u6210\uFF0C\u4EE5\u53CA\u6570\u636E\u5E93\u7684\u4FEE\u6539\u64CD\u4F5C\u3002</p><h3 id="\u505A\u5230\u4E86\u4EC0\u4E48\u7A0B\u5EA6\uFF0C\u5E93\u5B58\u91CF\u4E0E\u5E76\u53D1\u5EA6\u662F\u591A\u5C11" tabindex="-1">\u505A\u5230\u4E86\u4EC0\u4E48\u7A0B\u5EA6\uFF0C\u5E93\u5B58\u91CF\u4E0E\u5E76\u53D1\u5EA6\u662F\u591A\u5C11 <a class="header-anchor" href="#\u505A\u5230\u4E86\u4EC0\u4E48\u7A0B\u5EA6\uFF0C\u5E93\u5B58\u91CF\u4E0E\u5E76\u53D1\u5EA6\u662F\u591A\u5C11" aria-hidden="true">#</a></h3><p>TPS\uFF1A\u5355\u673A2000</p><h3 id="mysql\u4E2D\u7684\u8868\u662F\u600E\u4E48\u8BBE\u8BA1\u7684" tabindex="-1">MySQL\u4E2D\u7684\u8868\u662F\u600E\u4E48\u8BBE\u8BA1\u7684 <a class="header-anchor" href="#mysql\u4E2D\u7684\u8868\u662F\u600E\u4E48\u8BBE\u8BA1\u7684" aria-hidden="true">#</a></h3><p>item\u8868\u3001item_stock\u8868\u3001order\u8868\u3001\u7528\u6237\u4FE1\u606F\u8868</p><h3 id="\u5982\u4F55\u53EA\u4F7F\u7528mysql\u4FDD\u8BC1\u5546\u54C1\u6CA1\u6709\u8D85\u5356" tabindex="-1">\u5982\u4F55\u53EA\u4F7F\u7528MySQL\u4FDD\u8BC1\u5546\u54C1\u6CA1\u6709\u8D85\u5356 <a class="header-anchor" href="#\u5982\u4F55\u53EA\u4F7F\u7528mysql\u4FDD\u8BC1\u5546\u54C1\u6CA1\u6709\u8D85\u5356" aria-hidden="true">#</a></h3><p>\u5C06\u67E5\u5E93\u5B58\u3001\u51CF\u5E93\u5B58\u4E24\u4E2Asql\u8BED\u53E5\u4F5C\u4E3A\u4E00\u4E2A\u4E8B\u52A1\u8FDB\u884C\u63A7\u5236\uFF0C\u4FDD\u8BC1\u6BCF\u4E00\u4E2A\u5E93\u5B58\u53EA\u80FD\u88AB\u4E00\u4E2A\u7528\u6237\u6D88\u8D39\u3002\u4E24\u6761\u8BED\u53E5\u90FD\u6267\u884C\u6210\u529F\u8FDB\u884C\u4E8B\u52A1\u63D0\u4EA4\uFF0C\u5426\u5219\u56DE\u6EDA\uFF0C\u4F46\u8FD9\u6837\u4F1A\u5BFC\u81F4\u5E76\u53D1\u5F88\u4F4E\uFF0C\u4F46\u4E5F\u6CA1\u6709\u529E\u6CD5\u3002</p><h3 id="\u6570\u636E\u5E93\u6539\u5E93\u5B58\u7684sql" tabindex="-1">\u6570\u636E\u5E93\u6539\u5E93\u5B58\u7684SQL <a class="header-anchor" href="#\u6570\u636E\u5E93\u6539\u5E93\u5B58\u7684sql" aria-hidden="true">#</a></h3><div class="language-shell"><span class="copy"></span><pre><code><span class="line"><span style="color:#C9D1D9;">update table </span><span style="color:#79C0FF;">set</span><span style="color:#C9D1D9;"> stock = stock -1 where prom_id = </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> and stock </span><span style="color:#FF7B72;">&gt;</span><span style="color:#C9D1D9;"> 1</span><span style="color:#FF7B72;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="\u5982\u4F55\u9632\u6B62\u7528\u6237\u4E00\u76F4\u70B9\u51FB\u4E0B\u5355\u6309\u94AE" tabindex="-1">\u5982\u4F55\u9632\u6B62\u7528\u6237\u4E00\u76F4\u70B9\u51FB\u4E0B\u5355\u6309\u94AE <a class="header-anchor" href="#\u5982\u4F55\u9632\u6B62\u7528\u6237\u4E00\u76F4\u70B9\u51FB\u4E0B\u5355\u6309\u94AE" aria-hidden="true">#</a></h3><div class="tip custom-block"><p class="custom-block-title">\u524D\u7AEF\u9650\u5236</p><p>\u4E00\u6B21\u70B9\u51FB\u4E4B\u540E\u6309\u94AE\u7F6E\u7070\u51E0\u79D2\u949F</p></div><div class="tip custom-block"><p class="custom-block-title">\u540E\u7AEF\u9650\u5236</p><p>\u7531\u4E8E\u79D2\u6740\u4EE4\u724C\u7684\u8BBE\u7F6E\uFF0C\u7528\u6237\u7684\u4E00\u4E2A\u4E0B\u5355\u8BF7\u6C42\u4F1A\u5148\u5224\u65AD\u7528\u6237\u5F53\u524D\u662F\u5426\u5DF2\u7ECF\u6301\u6709\u4EE4\u724C\u4E86\uFF0C\u56E0\u4E3A\u7528\u6237\u5168\u5C40\u53EA\u80FD\u83B7\u53D6\u4E00\u6B21\u4EE4\u724C\uFF0C \u7136\u540E\u5B58\u5165Redis\u7F13\u5B58\u4E2D\u3002\u7528\u6237\u6709\u4EE4\u724C\u7684\u8BDD\u76F4\u63A5\u8FD4\u56DE\u201C\u6B63\u5728\u62A2\u8D2D\u4E2D\u201D\u3002</p></div>`,104),i=[p];function o(t,c,r,d,h,u){return a(),l("div",null,i)}var v=s(n,[["render",o]]);export{D as __pageData,v as default};
