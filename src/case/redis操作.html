<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>redis 操作</title>
    <meta name="description" content="VitePress">
    <link rel="stylesheet" href="/vitepress-deploy/assets/style.c6a8f29c.css">
    <link rel="modulepreload" href="/vitepress-deploy/assets/app.2a154df8.js">
    <link rel="modulepreload" href="/vitepress-deploy/assets/src_case_redis操作.md.2f51e4c7.lean.js">
    
    <link rel="icon" href="https://cn.vitejs.dev/logo-with-shadow.png">
  <script>(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-581d5782><!--[--><!--]--><!--[--><span tabindex="-1" data-v-2c02b834></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-2c02b834> Skip to content </a><!--]--><!----><header class="VPNav no-sidebar" data-v-581d5782 data-v-119e663c><div class="VPNavBar" data-v-119e663c data-v-1f7b674d><div class="container" data-v-1f7b674d><div class="VPNavBarTitle" data-v-1f7b674d data-v-ed531ba2><a class="title" href="/vitepress-deploy/" data-v-ed531ba2><!--[--><img class="VPImage logo" src="https://cn.vitejs.dev/logo-with-shadow.png" data-v-81172f9c><!--]--><!--[-->首页<!--]--></a></div><div class="content" data-v-1f7b674d><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-1f7b674d data-v-192c109a><span id="main-nav-aria-label" class="visually-hidden" data-v-192c109a>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/vitepress-deploy/src/view/index.html" data-v-192c109a data-v-4d31877c data-v-8dd034e6><!--[-->问答<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/vitepress-deploy/src/web/index.html" data-v-192c109a data-v-4d31877c data-v-8dd034e6><!--[-->前端<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/vitepress-deploy/src/deploy/index.html" data-v-192c109a data-v-4d31877c data-v-8dd034e6><!--[-->部署<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/vitepress-deploy/src/kit/index.html" data-v-192c109a data-v-4d31877c data-v-8dd034e6><!--[-->工具<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/vitepress-deploy/src/case/index.html" data-v-192c109a data-v-4d31877c data-v-8dd034e6><!--[-->案例<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-1f7b674d data-v-5cf7609e><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-5cf7609e data-v-766c3cb1 data-v-d6dfd774><span class="check" data-v-d6dfd774><span class="icon" data-v-d6dfd774><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-766c3cb1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-766c3cb1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-1f7b674d data-v-a767cbbe data-v-e03f590e><!--[--><a class="VPSocialLink" href="https://github.com/space2030?tab=repositories" title="github" target="_blank" rel="noopener noreferrer" data-v-e03f590e data-v-3dd9970c><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-3dd9970c><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg><span class="visually-hidden" data-v-3dd9970c>github</span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-1f7b674d data-v-6a32f7d6 data-v-44cec2e6><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-44cec2e6><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-44cec2e6><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-44cec2e6><div class="VPMenu" data-v-44cec2e6 data-v-ddb22576><!----><!--[--><!--[--><!----><div class="group" data-v-6a32f7d6><div class="item appearance" data-v-6a32f7d6><p class="label" data-v-6a32f7d6>Appearance</p><div class="appearance-action" data-v-6a32f7d6><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-6a32f7d6 data-v-766c3cb1 data-v-d6dfd774><span class="check" data-v-d6dfd774><span class="icon" data-v-d6dfd774><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-766c3cb1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-766c3cb1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-6a32f7d6><div class="item social-links" data-v-6a32f7d6><div class="VPSocialLinks social-links-list" data-v-6a32f7d6 data-v-e03f590e><!--[--><a class="VPSocialLink" href="https://github.com/space2030?tab=repositories" title="github" target="_blank" rel="noopener noreferrer" data-v-e03f590e data-v-3dd9970c><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-3dd9970c><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg><span class="visually-hidden" data-v-3dd9970c>github</span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-1f7b674d data-v-3524c702><span class="container" data-v-3524c702><span class="top" data-v-3524c702></span><span class="middle" data-v-3524c702></span><span class="bottom" data-v-3524c702></span></span></button></div></div></div><!----></header><!----><!----><div class="VPContent" id="VPContent" data-v-581d5782 data-v-804f35da><div class="VPDoc" data-v-804f35da data-v-3886f8ec><div class="container" data-v-3886f8ec><div class="aside" data-v-3886f8ec><div class="aside-curtain" data-v-3886f8ec></div><div class="aside-container" data-v-3886f8ec><div class="aside-content" data-v-3886f8ec><div class="VPDocAside" data-v-3886f8ec data-v-a4f49d12><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline has-outline" data-v-a4f49d12 data-v-2d325df8><div class="content" data-v-2d325df8><div class="outline-marker" data-v-2d325df8></div><div class="outline-title" data-v-2d325df8>目录</div><nav aria-labelledby="doc-outline-aria-label" data-v-2d325df8><span class="visually-hidden" id="doc-outline-aria-label" data-v-2d325df8> Table of Contents for current page </span><ul class="root" data-v-2d325df8><!--[--><li style="" data-v-2d325df8><a class="outline-link" href="#_01-数据结构" data-v-2d325df8>01 数据结构</a><!----></li><li style="" data-v-2d325df8><a class="outline-link" href="#_02-通用指令" data-v-2d325df8>02 通用指令</a><!----></li><li style="" data-v-2d325df8><a class="outline-link" href="#_03-value为string类型" data-v-2d325df8>03 value为string类型</a><!----></li><li style="" data-v-2d325df8><a class="outline-link" href="#_04-value为list类型" data-v-2d325df8>04 value为list类型</a><!----></li><li style="" data-v-2d325df8><a class="outline-link" href="#_05-value为set类型" data-v-2d325df8>05 value为set类型</a><!----></li><li style="" data-v-2d325df8><a class="outline-link" href="#_06-value为zset（sorted-set）类型" data-v-2d325df8>06 value为zset（sorted set）类型</a><!----></li><li style="" data-v-2d325df8><a class="outline-link" href="#_07-spring-boot-redis" data-v-2d325df8>07 spring boot redis</a><!----></li><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-a4f49d12></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-3886f8ec><div class="content-container" data-v-3886f8ec><!--[--><!--]--><main class="main" data-v-3886f8ec><div style="position:relative;" class="vp-doc _vitepress-deploy_src_case_redis%E6%93%8D%E4%BD%9C" data-v-3886f8ec><div><h1 id="redis-操作" tabindex="-1">redis 操作 <a class="header-anchor" href="#redis-操作" aria-hidden="true">#</a></h1><h2 id="_01-数据结构" tabindex="-1">01 数据结构 <a class="header-anchor" href="#_01-数据结构" aria-hidden="true">#</a></h2><ul><li>String 二进制安全，可以包含任何数据，比如jpg图片或者序列化的对象，一个键最大能存储512M</li><li>Hash 字典，键值对集合，即编程语言中的Map类型，适合存储对象，并且可以像数据库中update一个属性一样只修改某一项属性值，Memcached中需要取出整个字符串反序列化成对象修改完再序列化存回去，场景存储，读取，修改用户属性</li><li>List 链表（双向链表），增删快，提供了操作某一段元素的API，场景最新消息排行，消息队列</li><li>Set 集合，哈希表实现，元素不重复，特性，添加，删除，查找的复杂度都是O(1)，为集合提供了求交集，并集，差集等操作，场景，共同好友，利用唯一性统计访问网站的所有独立IP，好友推荐时，根据tag求交集，大于某个阈值就可以推荐</li><li>Sorted Set 有序集合，将Set中元素增加一个权重参数score，元素按score有序排列，数据插入集合时，已经进行天然排序，场景，排行榜，带权重的消息队列</li></ul><h2 id="_02-通用指令" tabindex="-1">02 通用指令 <a class="header-anchor" href="#_02-通用指令" aria-hidden="true">#</a></h2><div class="language-shell"><span class="copy"></span><pre><code><span class="line"><span style="color:#8B949E;">#查看所有key</span></span>
<span class="line"><span style="color:#C9D1D9;">key</span><span style="color:#FF7B72;">*</span><span style="color:#C9D1D9;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#清空数据库并执行持久化操作</span></span>
<span class="line"><span style="color:#C9D1D9;">flushall</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#清空数据库，但是不执行持久化操作</span></span>
<span class="line"><span style="color:#C9D1D9;">flushdb</span></span>
<span class="line"></span></code></pre></div><h2 id="_03-value为string类型" tabindex="-1">03 value为string类型 <a class="header-anchor" href="#_03-value为string类型" aria-hidden="true">#</a></h2><div class="language-shell"><span class="copy"></span><pre><code><span class="line"><span style="color:#8B949E;">#设置值（重复set同一个key,会覆盖原来的value）</span></span>
<span class="line"><span style="color:#79C0FF;">set</span><span style="color:#C9D1D9;"> key value</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#获取值</span></span>
<span class="line"><span style="color:#C9D1D9;">get key</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#删除key</span></span>
<span class="line"><span style="color:#C9D1D9;">del key</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#批量插入</span></span>
<span class="line"><span style="color:#C9D1D9;">mset key1 value2 key2 value2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#value自增</span></span>
<span class="line"><span style="color:#C9D1D9;">incr key</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#value自减</span></span>
<span class="line"><span style="color:#C9D1D9;">decr key</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#指定增加多少</span></span>
<span class="line"><span style="color:#C9D1D9;">incrby key value</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#指定减少多少</span></span>
<span class="line"><span style="color:#C9D1D9;">decrby key value</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">获取原来的值并设置新值</span></span>
<span class="line"><span style="color:#C9D1D9;">getset key newValue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#获取value的长度</span></span>
<span class="line"><span style="color:#C9D1D9;">strlen key</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#key值存在则在key对应的value后面追加字符，不存在则创建</span></span>
<span class="line"><span style="color:#C9D1D9;">append key value</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#获取部分value值（左右包含，算下标）</span></span>
<span class="line"><span style="color:#C9D1D9;">getrange key start end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">如果key存在就不设置值，返回0，如果不存在key就设置值，返回1</span></span>
<span class="line"><span style="color:#C9D1D9;">setnx key value</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">为key设置过期时间（该过程不是原子性操作）</span></span>
<span class="line"><span style="color:#C9D1D9;">expire key +时间s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#查看key过期时间</span></span>
<span class="line"><span style="color:#C9D1D9;">ttl key</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">原子操作创建key并设置过期时间（重复set同一个key,会覆盖原来的value，刷新过期时间）</span></span>
<span class="line"><span style="color:#C9D1D9;">setex key seconds value</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#设置值，可以同时设置多个field,value（同一个key和field再次hset会覆盖之前的value）</span></span>
<span class="line"><span style="color:#C9D1D9;">hset key field value</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#获取值，首先制定key,然后指定获取该key的哪个属性</span></span>
<span class="line"><span style="color:#C9D1D9;">hget key field</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#设置多个属性，与hset类似</span></span>
<span class="line"><span style="color:#C9D1D9;">hmset key field1 value1 field2 value2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">hset：如果field是哈希表中的一个新建域，并且值设置成功，返回1，如果哈希表中域field已经存在且旧值已被新值覆盖，返回0</span></span>
<span class="line"><span style="color:#C9D1D9;">hmset：命令执行成功，返回ok，当key不是哈希表类型时，返回一个错误</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#获取多个属性的值</span></span>
<span class="line"><span style="color:#C9D1D9;">hmget key field1 field2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#获取key的所有属性与值</span></span>
<span class="line"><span style="color:#C9D1D9;">hgetall key</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#获取key中属性的个数</span></span>
<span class="line"><span style="color:#C9D1D9;">hlen key</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#删除key中某个属性，可以删除多个</span></span>
<span class="line"><span style="color:#C9D1D9;">hdel key field</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#原key的field不存在则set成功，返回1，否则失败，返回0</span></span>
<span class="line"><span style="color:#C9D1D9;">hsetnx key field value</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#获取当前key下所有的field</span></span>
<span class="line"><span style="color:#C9D1D9;">hkeys key</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#获取所有的value值</span></span>
<span class="line"><span style="color:#C9D1D9;">hvals key</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#判断key中是否存在某个field</span></span>
<span class="line"><span style="color:#C9D1D9;">hexists key field</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#为key中field值基础上增加step</span></span>
<span class="line"><span style="color:#C9D1D9;">hincrby key field step</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#为key中field值基础上增加step(小数)</span></span>
<span class="line"><span style="color:#C9D1D9;">hincrbyfloat key field step</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#获取key对应的value的长度</span></span>
<span class="line"><span style="color:#C9D1D9;">hstrlen key field</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">#设置过期时间</span></span>
<span class="line"><span style="color:#C9D1D9;">expire key second</span></span>
<span class="line"></span></code></pre></div><h2 id="_04-value为list类型" tabindex="-1">04 value为list类型 <a class="header-anchor" href="#_04-value为list类型" aria-hidden="true">#</a></h2><div class="language-shell"><span class="copy"></span><pre><code><span class="line"><span style="color:#8B949E;">#从链表左边（链表头）放数据</span></span>
<span class="line"><span style="color:#C9D1D9;">lpush key value [value ...]</span></span>
<span class="line"><span style="color:#8B949E;">#查看[start,end]中的数据，end-1表示最后</span></span>
<span class="line"><span style="color:#C9D1D9;">lrange key start end</span></span>
<span class="line"><span style="color:#8B949E;">#右边插入数据</span></span>
<span class="line"><span style="color:#C9D1D9;">rpush key value [value ...]</span></span>
<span class="line"><span style="color:#8B949E;">#弹出左边第一个元素</span></span>
<span class="line"><span style="color:#C9D1D9;">lpop key</span></span>
<span class="line"><span style="color:#8B949E;">#弹出右边第一个元素</span></span>
<span class="line"><span style="color:#C9D1D9;">rpop key</span></span>
<span class="line"><span style="color:#8B949E;">#查看链表总长度</span></span>
<span class="line"><span style="color:#C9D1D9;">llen key</span></span>
<span class="line"><span style="color:#8B949E;">#左侧阻塞式弹出</span></span>
<span class="line"><span style="color:#C9D1D9;">blpop key [key...] timeout</span></span>
<span class="line"><span style="color:#8B949E;">#右侧阻塞式弹出</span></span>
<span class="line"><span style="color:#C9D1D9;">brpop key [key...] timeout</span></span>
<span class="line"><span style="color:#8B949E;">#与lpush类似，但是lpushx会校验key是否存在，若key不存在则不进行任何操作</span></span>
<span class="line"><span style="color:#C9D1D9;">lpushx</span></span>
<span class="line"><span style="color:#8B949E;">#与rpush类似，但是rpushx会校验key是否存在，若key不存在则不进行任何操作</span></span>
<span class="line"><span style="color:#C9D1D9;">rpushx</span></span>
<span class="line"><span style="color:#8B949E;">#弹出key1的右边的元素，放入key2左边</span></span>
<span class="line"><span style="color:#C9D1D9;">rpoplpush key1 key2</span></span>
<span class="line"><span style="color:#8B949E;">#阻塞版本</span></span>
<span class="line"><span style="color:#C9D1D9;">brpoplpush</span></span>
<span class="line"><span style="color:#8B949E;">#获取key中index位置的值，负数就反过来数，-1为最后一个</span></span>
<span class="line"><span style="color:#C9D1D9;">lindex key index</span></span>
<span class="line"><span style="color:#8B949E;">#count &gt; 0 从左边删除count个value</span></span>
<span class="line"><span style="color:#8B949E;">#count &lt; 0 从右边删除count个value</span></span>
<span class="line"><span style="color:#8B949E;">#count = 0 删除所有的value</span></span>
<span class="line"><span style="color:#C9D1D9;">lrem key count value</span></span>
<span class="line"></span></code></pre></div><h2 id="_05-value为set类型" tabindex="-1">05 value为set类型 <a class="header-anchor" href="#_05-value为set类型" aria-hidden="true">#</a></h2><div class="language-shell"><span class="copy"></span><pre><code><span class="line"><span style="color:#8B949E;">#set集合中添加元素</span></span>
<span class="line"><span style="color:#C9D1D9;">sadd key element [element...]</span></span>
<span class="line"><span style="color:#8B949E;">#查看集合所有的元素</span></span>
<span class="line"><span style="color:#C9D1D9;">smembers key</span></span>
<span class="line"><span style="color:#8B949E;">#查看元素是否属于该集合，1存在，0不存在</span></span>
<span class="line"><span style="color:#C9D1D9;">sismember key element</span></span>
<span class="line"><span style="color:#8B949E;">#删除集合元素</span></span>
<span class="line"><span style="color:#C9D1D9;">srem key element [element...]</span></span>
<span class="line"><span style="color:#8B949E;">#查看集合元素数量</span></span>
<span class="line"><span style="color:#C9D1D9;">scard key</span></span>
<span class="line"><span style="color:#8B949E;">#随机获取集合中某一个元素</span></span>
<span class="line"><span style="color:#8B949E;">#n是正数：返回n个不重复的数</span></span>
<span class="line"><span style="color:#8B949E;">#n是负数：返回n个可能重复的数</span></span>
<span class="line"><span style="color:#C9D1D9;">srandmember key [n]</span></span>
<span class="line"><span style="color:#8B949E;">#默认弹出一个元素，或者弹出指定个数的元素</span></span>
<span class="line"><span style="color:#C9D1D9;">spop key [n]</span></span>
<span class="line"><span style="color:#8B949E;">#多个集合的交集</span></span>
<span class="line"><span style="color:#C9D1D9;">sinter key1 key2...</span></span>
<span class="line"><span style="color:#8B949E;">#返回第一个集合有后面集合都没有的元素（差集）</span></span>
<span class="line"><span style="color:#C9D1D9;">sdiff key1 key2 key3...</span></span>
<span class="line"><span style="color:#8B949E;">#所有集合的并集</span></span>
<span class="line"><span style="color:#C9D1D9;">sunion key1 key2 key3 ...</span></span>
<span class="line"><span style="color:#8B949E;">#找到set1与set2的交集存放在set中</span></span>
<span class="line"><span style="color:#C9D1D9;">sinterstore </span><span style="color:#79C0FF;">set</span><span style="color:#C9D1D9;"> set1 set2</span></span>
<span class="line"></span></code></pre></div><h2 id="_06-value为zset（sorted-set）类型" tabindex="-1">06 value为zset（sorted set）类型 <a class="header-anchor" href="#_06-value为zset（sorted-set）类型" aria-hidden="true">#</a></h2><div class="language-shell"><span class="copy"></span><pre><code><span class="line"><span style="color:#8B949E;">#添加元素，每个元素都会携带一个分数</span></span>
<span class="line"><span style="color:#C9D1D9;">zadd key score member1 score member2</span></span>
<span class="line"><span style="color:#8B949E;">#根据下标查看元素，默认分数升序排序</span></span>
<span class="line"><span style="color:#C9D1D9;">zrange key start end [withscores]</span></span>
<span class="line"><span style="color:#8B949E;">#类似上面，反取</span></span>
<span class="line"><span style="color:#C9D1D9;">zrevrange key start end [withscores]</span></span>
<span class="line"><span style="color:#8B949E;">#取score1到score2分数之间的元素</span></span>
<span class="line"><span style="color:#C9D1D9;">zrangebyscore key score1 score2</span></span>
<span class="line"><span style="color:#8B949E;">#反取</span></span>
<span class="line"><span style="color:#C9D1D9;">zrevrangebyscore key max min [withscores]</span></span>
<span class="line"><span style="color:#8B949E;">#删除元素</span></span>
<span class="line"><span style="color:#C9D1D9;">zrem key member</span></span>
<span class="line"><span style="color:#8B949E;">#个数</span></span>
<span class="line"><span style="color:#C9D1D9;">zcard key</span></span>
<span class="line"><span style="color:#8B949E;">#查看某个元素的分数</span></span>
<span class="line"><span style="color:#C9D1D9;">zscore key member</span></span>
<span class="line"><span style="color:#8B949E;">#查看某个元素在集合中排名，默认按分数升序（排名从0开始的）</span></span>
<span class="line"><span style="color:#C9D1D9;">zrank key member</span></span>
<span class="line"><span style="color:#8B949E;">#反排名</span></span>
<span class="line"><span style="color:#C9D1D9;">zrevrank key member</span></span>
<span class="line"><span style="color:#8B949E;">#为某个元素加分</span></span>
<span class="line"><span style="color:#C9D1D9;">zincrby increment member</span></span>
<span class="line"><span style="color:#8B949E;">#统计min到max分数间的个数</span></span>
<span class="line"><span style="color:#C9D1D9;">zcount key min max</span></span>
<span class="line"><span style="color:#8B949E;">#根据分数段删除</span></span>
<span class="line"><span style="color:#C9D1D9;">zremrangebyscore key min max</span></span>
<span class="line"><span style="color:#8B949E;">#根据排名删除</span></span>
<span class="line"><span style="color:#C9D1D9;">zremrangebyrank key start end</span></span>
<span class="line"><span style="color:#8B949E;">#这里numkeys表示需要做交集的key的个数</span></span>
<span class="line"><span style="color:#C9D1D9;">zinterstore destination numkeys key[key...]</span></span>
<span class="line"><span style="color:#8B949E;">#这里numkeys代表需要做并集的key的个数</span></span>
<span class="line"><span style="color:#C9D1D9;">zunionstore destination numkeys key[key...]</span></span>
<span class="line"></span></code></pre></div><h2 id="_07-spring-boot-redis" tabindex="-1">07 spring boot redis <a class="header-anchor" href="#_07-spring-boot-redis" aria-hidden="true">#</a></h2><div class="language-html"><span class="copy"></span><pre><code><span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA198;font-style:italic;">dependency</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">groupId</span><span style="color:#C9D1D9;">&gt;org.springframework.boot&lt;/</span><span style="color:#FFA198;font-style:italic;">groupId</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">artifactId</span><span style="color:#C9D1D9;">&gt;spring-boot-starter-data-redis&lt;/</span><span style="color:#FFA198;font-style:italic;">artifactId</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;/</span><span style="color:#FFA198;font-style:italic;">dependency</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA198;font-style:italic;">dependency</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">groupId</span><span style="color:#C9D1D9;">&gt;org.projectlombok&lt;/</span><span style="color:#FFA198;font-style:italic;">groupId</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">artifactId</span><span style="color:#C9D1D9;">&gt;lombok&lt;/</span><span style="color:#FFA198;font-style:italic;">artifactId</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;/</span><span style="color:#FFA198;font-style:italic;">dependency</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA198;font-style:italic;">dependency</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">groupId</span><span style="color:#C9D1D9;">&gt;com.google.guava&lt;/</span><span style="color:#FFA198;font-style:italic;">groupId</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">artifactId</span><span style="color:#C9D1D9;">&gt;guava&lt;/</span><span style="color:#FFA198;font-style:italic;">artifactId</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">version</span><span style="color:#C9D1D9;">&gt;27.0.1-jre&lt;/</span><span style="color:#FFA198;font-style:italic;">version</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;/</span><span style="color:#FFA198;font-style:italic;">dependency</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#8B949E;">&lt;!--json工具--&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA198;font-style:italic;">dependency</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">groupId</span><span style="color:#C9D1D9;">&gt;com.fasterxml.jackson.core&lt;/</span><span style="color:#FFA198;font-style:italic;">groupId</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">artifactId</span><span style="color:#C9D1D9;">&gt;jackson-core&lt;/</span><span style="color:#FFA198;font-style:italic;">artifactId</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">version</span><span style="color:#C9D1D9;">&gt;2.9.8&lt;/</span><span style="color:#FFA198;font-style:italic;">version</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;/</span><span style="color:#FFA198;font-style:italic;">dependency</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA198;font-style:italic;">dependency</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">groupId</span><span style="color:#C9D1D9;">&gt;com.fasterxml.jackson.core&lt;/</span><span style="color:#FFA198;font-style:italic;">groupId</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">artifactId</span><span style="color:#C9D1D9;">&gt;jackson-annotations&lt;/</span><span style="color:#FFA198;font-style:italic;">artifactId</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">version</span><span style="color:#C9D1D9;">&gt;2.9.8&lt;/</span><span style="color:#FFA198;font-style:italic;">version</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;/</span><span style="color:#FFA198;font-style:italic;">dependency</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA198;font-style:italic;">dependency</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">groupId</span><span style="color:#C9D1D9;">&gt;com.fasterxml.jackson.core&lt;/</span><span style="color:#FFA198;font-style:italic;">groupId</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">artifactId</span><span style="color:#C9D1D9;">&gt;jackson-databind&lt;/</span><span style="color:#FFA198;font-style:italic;">artifactId</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#FFA198;font-style:italic;">version</span><span style="color:#C9D1D9;">&gt;2.9.8&lt;/</span><span style="color:#FFA198;font-style:italic;">version</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;/</span><span style="color:#FFA198;font-style:italic;">dependency</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><ul><li>配置文件</li></ul><div class="language-text"><span class="copy"></span><pre><code><span class="line"><span style="color:#c9d1d9;">#application.properties文件</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span>
<span class="line"><span style="color:#c9d1d9;">#Redis数据库索引（默认为0）</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.redis.database = 0</span></span>
<span class="line"><span style="color:#c9d1d9;">#Redis服务器地址，写你的ip</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.redis.host = 192.168.100.100</span></span>
<span class="line"><span style="color:#c9d1d9;">#Redis服务器连接端口</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.redis.port = 6379</span></span>
<span class="line"><span style="color:#c9d1d9;">#Redis服务器连接密码（默认为空）</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.redis.password = </span></span>
<span class="line"><span style="color:#c9d1d9;">#连接池最大连接数（使用负值表示没有限制，类似mysql的连接池）</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.redis.jedis.pool.max-active = 200</span></span>
<span class="line"><span style="color:#c9d1d9;">#连接池最大阻塞等待时间（使用负值表示没有限制）</span></span>
<span class="line"><span style="color:#c9d1d9;">#表示连接池的链接拿完了，现在去申请需要等待的时间</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.redis.jedis.pool.max-wait = -1</span></span>
<span class="line"><span style="color:#c9d1d9;">#连接池中的最大空闲连接</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.redis.jedis.pool.max-idle = 10</span></span>
<span class="line"><span style="color:#c9d1d9;">#连接池中的最小空闲连接</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.redis.jedis.popl.min-idle = 0</span></span>
<span class="line"><span style="color:#c9d1d9;">#连接超时时间（毫秒）去连接redis服务端</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.redis.timeout = 6000</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span>
<span class="line"><span style="color:#c9d1d9;">#druid</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.druid.url = jdbc:mysql://192.168.100.100:3306/redis?useUnicode=true&amp;characterEncoding=utf-8&amp;serverTimezone=GMT</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.druid.driverClassName = com.mysql.cj.jdbc.Driver</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.druid.username = root</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.druid.password = root</span></span>
<span class="line"><span style="color:#c9d1d9;">#最大连接数</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.druid.maxActive = 30</span></span>
<span class="line"><span style="color:#c9d1d9;">#最小连接数</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.druid.minIdle = 5</span></span>
<span class="line"><span style="color:#c9d1d9;">#获得连接的最大等待时间</span></span>
<span class="line"><span style="color:#c9d1d9;">spring.druid.maxWait = 10000</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span>
<span class="line"><span style="color:#c9d1d9;">#指定mybatis配置文件地址</span></span>
<span class="line"><span style="color:#c9d1d9;">mybatis.config-location = classpath:mybatis/mybatis-config.xml</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span></code></pre></div><ul><li>配置类</li></ul><div class="language-java"><span class="copy"></span><pre><code><span class="line"><span style="color:#FF7B72;">package</span><span style="color:#C9D1D9;"> com.xmcc.redis.config;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">@</span><span style="color:#FF7B72;">Configuration</span></span>
<span class="line"><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">class</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">RedisConfig</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#8B949E;">    /**</span></span>
<span class="line"><span style="color:#8B949E;">    新建restTemplate交给spring容器管理，springboot其实已经自动注入了RedisTemplate,但是泛型是RedisTemp&lt;Object,Object&gt;，而且没有指定序列化的方式，而我们需要key都是string类型的，避免频繁的类型转换，所以重写，当手动去注入一个RedisTemplate后，springboot将不会自动注入，RedisCOnnectionFactory:springboot自动读取配置文件，然后注入</span></span>
<span class="line"><span style="color:#8B949E;">     */</span></span>
<span class="line"><span style="color:#C9D1D9;">    @</span><span style="color:#FF7B72;">Bean</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> RedisTemplate&lt;</span><span style="color:#FF7B72;">String</span><span style="color:#C9D1D9;">,</span><span style="color:#FF7B72;">Object</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#D2A8FF;">redisTemplate</span><span style="color:#C9D1D9;">(RedisConnectionFactory </span><span style="color:#FFA657;">factory</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        RedisTemplate</span><span style="color:#FFA657;">&lt;</span><span style="color:#FF7B72;">String</span><span style="color:#FFA657;">,</span><span style="color:#FF7B72;">Object</span><span style="color:#FFA657;">&gt; </span><span style="color:#C9D1D9;">template</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">=</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> RedisTemplate&lt;&gt;();</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">//设置连接工厂，工厂用于创建连接</span></span>
<span class="line"><span style="color:#C9D1D9;">        template.</span><span style="color:#D2A8FF;">setConnectionFactory</span><span style="color:#C9D1D9;">(factory);</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">//设置自定义序列化方式</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#D2A8FF;">setSerializeConfig</span><span style="color:#C9D1D9;">(template,factory);</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> template;</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#8B949E;">    /**</span></span>
<span class="line"><span style="color:#8B949E;">    	为什么要序列化？</span></span>
<span class="line"><span style="color:#8B949E;">    		序列化能加快网络传输，而且redis的value都是字符串，我们希望value放入任意的数据，就需要手动去序列化为字符串，这直接配置了，以后传入任意value的时候，就会自动序列化。</span></span>
<span class="line"><span style="color:#8B949E;">    		举例，我们现在想保存一个student对象到redis，但是redis只能存字符串，那么我们需要把对象通过json工具类转换为字符串，再去存入，写了这个就不需要转了，传入student对象，内部自动帮助我们转换为字符串。	</span></span>
<span class="line"><span style="color:#8B949E;">    */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">private</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">void</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">setSerializeConfig</span><span style="color:#C9D1D9;">(RedisTemplate&lt;</span><span style="color:#FF7B72;">String</span><span style="color:#C9D1D9;">,</span><span style="color:#FF7B72;">Object</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FFA657;">redisTemplate</span><span style="color:#C9D1D9;">, RedisConnectionFactory </span><span style="color:#FFA657;">redisConnectionFactory</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// 设置连接工厂</span></span>
<span class="line"><span style="color:#C9D1D9;">        redisTemplate.</span><span style="color:#D2A8FF;">setConnectionFactory</span><span style="color:#C9D1D9;">(redisConnectionFactory);</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">//对字符串采取普通的序列化方式，适用于key因为我们一般采取简单字符串作为key</span></span>
<span class="line"><span style="color:#C9D1D9;">        StringRedisSerializer</span><span style="color:#FFA657;"> </span><span style="color:#C9D1D9;">stringRedisSerializer</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">StringRedisSerializer</span><span style="color:#C9D1D9;">();</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">//普通的String类型的key，采用普通序列化方式</span></span>
<span class="line"><span style="color:#C9D1D9;">        redisTemplate.</span><span style="color:#D2A8FF;">serKeySerializer</span><span style="color:#C9D1D9;">(stringRedisSerializer);</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">//普通hash类型的key也使用普通序列化方式</span></span>
<span class="line"><span style="color:#C9D1D9;">        redisTemplate.</span><span style="color:#D2A8FF;">setHashKeySerializer</span><span style="color:#C9D1D9;">(stringRedisSerializer);</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">//解决查询缓存转换异常的问题，springboot自带的jackson序列化，但会有一定的问题</span></span>
<span class="line"><span style="color:#C9D1D9;">        Jackson2JsonRedisSerializer</span><span style="color:#FFA657;"> </span><span style="color:#C9D1D9;">jackson2JsonRedisSerializer</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">=</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">Jackson2JsonRedisSerializer</span><span style="color:#C9D1D9;">(Object.class);</span></span>
<span class="line"><span style="color:#C9D1D9;">        ObjectMapper</span><span style="color:#FFA657;"> </span><span style="color:#C9D1D9;">om</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">ObjectMapper</span><span style="color:#C9D1D9;">();</span></span>
<span class="line"><span style="color:#C9D1D9;">        om.</span><span style="color:#D2A8FF;">setVisibility</span><span style="color:#C9D1D9;">(PropertyAccessor.ALL,JsonAutoDetect.Visibility.ANY);</span></span>
<span class="line"><span style="color:#C9D1D9;">        om.</span><span style="color:#D2A8FF;">enableDefaultTyping</span><span style="color:#C9D1D9;">(ObjectMapper.DefaultTyping.NON_FINAL);</span></span>
<span class="line"><span style="color:#C9D1D9;">        jackson2JsonRedisSerializer.</span><span style="color:#D2A8FF;">serObjectMapper</span><span style="color:#C9D1D9;">(om);</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">//普通的值采用jackson方式自动序列化</span></span>
<span class="line"><span style="color:#C9D1D9;">        redisTemplate.</span><span style="color:#D2A8FF;">setValueSerializer</span><span style="color:#C9D1D9;">(jackson2JsonRedisSerializer);</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">//hash类型的值也采用jackson方式序列化</span></span>
<span class="line"><span style="color:#C9D1D9;">        redisTemplate.</span><span style="color:#D2A8FF;">setHashValueSerializer</span><span style="color:#C9D1D9;">(jackson2JsonRedisSerializer);</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">//属性设置完成afterPropertiesSet就会被调用，可以对设置不成功的做一些默认处理</span></span>
<span class="line"><span style="color:#C9D1D9;">        redisTemplate.</span><span style="color:#D2A8FF;">afterPropertiesSet</span><span style="color:#C9D1D9;">();</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">   </span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre></div><ul><li>工具类</li></ul><div class="language-java"><span class="copy"></span><pre><code><span class="line"></span>
<span class="line"><span style="color:#FF7B72;">package</span><span style="color:#C9D1D9;"> com.xmcc.redis01.util;</span></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> lombok.extern.slf4j.Slf4j;</span></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> org.springframework.beans.factory.annotation.Autowired;</span></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> org.springframework.data.redis.core.RedisTemplate;</span></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> org.springframework.stereotype.Component;</span></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> org.springframework.util.CollectionUtils;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> java.util.concurrent.TimeUnit;</span></span>
<span class="line"><span style="color:#C9D1D9;">@</span><span style="color:#FF7B72;">Component</span></span>
<span class="line"><span style="color:#C9D1D9;">@</span><span style="color:#FF7B72;">Slf4j</span></span>
<span class="line"><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">class</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">RedisUtils</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    @</span><span style="color:#FF7B72;">Autowired</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">private</span><span style="color:#C9D1D9;"> RedisTemplate</span><span style="color:#FFA657;">&lt;</span><span style="color:#FF7B72;">String</span><span style="color:#FFA657;">,</span><span style="color:#FF7B72;">Object</span><span style="color:#FFA657;">&gt; </span><span style="color:#C9D1D9;">redisTemplate;</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">//get</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> Object </span><span style="color:#D2A8FF;">get</span><span style="color:#C9D1D9;">(String </span><span style="color:#FFA657;">key</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> key</span><span style="color:#FF7B72;">==</span><span style="color:#79C0FF;">null</span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> redisTemplate.</span><span style="color:#D2A8FF;">opsForValue</span><span style="color:#C9D1D9;">().</span><span style="color:#D2A8FF;">get</span><span style="color:#C9D1D9;">(key);</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">//set</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">boolean</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">set</span><span style="color:#C9D1D9;">(String </span><span style="color:#FFA657;">key</span><span style="color:#C9D1D9;">,Object </span><span style="color:#FFA657;">value</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">try</span><span style="color:#C9D1D9;">{</span></span>
<span class="line"><span style="color:#C9D1D9;">            redisTemplate.</span><span style="color:#D2A8FF;">opsForValue</span><span style="color:#C9D1D9;">().</span><span style="color:#D2A8FF;">set</span><span style="color:#C9D1D9;">(key,value);</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#C9D1D9;">        } </span><span style="color:#FF7B72;">catch</span><span style="color:#C9D1D9;"> (Exception </span><span style="color:#FFA657;">e</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">            log.</span><span style="color:#D2A8FF;">error</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;redis set value exception:{}&quot;</span><span style="color:#C9D1D9;">,e);</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">//setex</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">boolean</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">setex</span><span style="color:#C9D1D9;">(String </span><span style="color:#FFA657;">key</span><span style="color:#C9D1D9;">,Object </span><span style="color:#FFA657;">value</span><span style="color:#C9D1D9;">,</span><span style="color:#FF7B72;">long</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">expire</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">try</span><span style="color:#C9D1D9;">{</span></span>
<span class="line"><span style="color:#C9D1D9;">            redisTemplate.</span><span style="color:#D2A8FF;">opsForValue</span><span style="color:#C9D1D9;">().</span><span style="color:#D2A8FF;">set</span><span style="color:#C9D1D9;">(key,value,expire,TimeUnit.SECONDS);</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#C9D1D9;">        } </span><span style="color:#FF7B72;">catch</span><span style="color:#C9D1D9;"> (Exception </span><span style="color:#FFA657;">e</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">boolean</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">expire</span><span style="color:#C9D1D9;">(String </span><span style="color:#FFA657;">key</span><span style="color:#C9D1D9;">,</span><span style="color:#FF7B72;">long</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">expire</span><span style="color:#C9D1D9;">){</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">try</span><span style="color:#C9D1D9;">{</span><span style="color:#8B949E;">//这儿没有ops什么的是因为每种数据类型都能设置过期时间</span></span>
<span class="line"><span style="color:#C9D1D9;">            redisTemplate.</span><span style="color:#D2A8FF;">expire</span><span style="color:#C9D1D9;">(key,expire,TimeUnit.SECONDS);</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span><span style="color:#FF7B72;">catch</span><span style="color:#C9D1D9;"> (Exception </span><span style="color:#FFA657;">e</span><span style="color:#C9D1D9;">){</span></span>
<span class="line"><span style="color:#C9D1D9;">            log.</span><span style="color:#D2A8FF;">error</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;redis set key expire exception:{}&quot;</span><span style="color:#C9D1D9;">,e);</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">    /**</span></span>
<span class="line"><span style="color:#8B949E;">     *</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">key</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@return</span><span style="color:#8B949E;"> 获取key的过期时间</span></span>
<span class="line"><span style="color:#8B949E;">     */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">long</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">ttl</span><span style="color:#C9D1D9;">(String </span><span style="color:#FFA657;">key</span><span style="color:#C9D1D9;">){</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> redisTemplate.</span><span style="color:#D2A8FF;">getExpire</span><span style="color:#C9D1D9;">(key);</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">    /**</span></span>
<span class="line"><span style="color:#8B949E;">     *</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">keys</span><span style="color:#8B949E;"> 删除key 可变参数</span></span>
<span class="line"><span style="color:#8B949E;">     */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">void</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">del</span><span style="color:#C9D1D9;">(String ...</span><span style="color:#FFA657;">keys</span><span style="color:#C9D1D9;">){</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;">(keys</span><span style="color:#FF7B72;">!=</span><span style="color:#79C0FF;">null</span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;">keys.length</span><span style="color:#FF7B72;">&gt;</span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">            redisTemplate.</span><span style="color:#D2A8FF;">delete</span><span style="color:#C9D1D9;">(CollectionUtils.</span><span style="color:#D2A8FF;">arrayToList</span><span style="color:#C9D1D9;">(keys));</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">    /**</span></span>
<span class="line"><span style="color:#8B949E;">     *</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">key</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">step</span><span style="color:#8B949E;">  传入正数 就是加多少 传入负数就是减多少</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@return</span></span>
<span class="line"><span style="color:#8B949E;">     */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">long</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">incrBy</span><span style="color:#C9D1D9;">(String </span><span style="color:#FFA657;">key</span><span style="color:#C9D1D9;">,</span><span style="color:#FF7B72;">long</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">step</span><span style="color:#C9D1D9;">){</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> redisTemplate.</span><span style="color:#D2A8FF;">opsForValue</span><span style="color:#C9D1D9;">().</span><span style="color:#D2A8FF;">increment</span><span style="color:#C9D1D9;">(key,step);</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">    /**</span></span>
<span class="line"><span style="color:#8B949E;">     *</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">key</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">value</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@return</span><span style="color:#8B949E;">  如果该key存在就返回false 设置不成功 key不存在就返回ture设置成功</span></span>
<span class="line"><span style="color:#8B949E;">     */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">boolean</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">setnx</span><span style="color:#C9D1D9;">(String </span><span style="color:#FFA657;">key</span><span style="color:#C9D1D9;">,Object </span><span style="color:#FFA657;">value</span><span style="color:#C9D1D9;">){</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> redisTemplate.</span><span style="color:#D2A8FF;">opsForValue</span><span style="color:#C9D1D9;">().</span><span style="color:#D2A8FF;">setIfAbsent</span><span style="color:#C9D1D9;">(key,value);</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">    /**</span></span>
<span class="line"><span style="color:#8B949E;">     *  原子操作</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">key</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">value</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">expire</span><span style="color:#8B949E;">  在上面方法加上过期时间设置</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@return</span></span>
<span class="line"><span style="color:#8B949E;">     */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">boolean</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">setnxAndExpire</span><span style="color:#C9D1D9;">(String </span><span style="color:#FFA657;">key</span><span style="color:#C9D1D9;">,Object </span><span style="color:#FFA657;">value</span><span style="color:#C9D1D9;">,</span><span style="color:#FF7B72;">long</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">expire</span><span style="color:#C9D1D9;">){</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> redisTemplate.</span><span style="color:#D2A8FF;">opsForValue</span><span style="color:#C9D1D9;">().</span><span style="color:#D2A8FF;">setIfAbsent</span><span style="color:#C9D1D9;">(key,value,expire,TimeUnit.SECONDS);</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">    /**</span></span>
<span class="line"><span style="color:#8B949E;">     *</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">key</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">value</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@return</span><span style="color:#8B949E;">  如果该key存在就返回之前的value  不存在就返回null</span></span>
<span class="line"><span style="color:#8B949E;">     */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> Object </span><span style="color:#D2A8FF;">getAndSet</span><span style="color:#C9D1D9;">(String </span><span style="color:#FFA657;">key</span><span style="color:#C9D1D9;">,Object </span><span style="color:#FFA657;">value</span><span style="color:#C9D1D9;">){</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> redisTemplate.</span><span style="color:#D2A8FF;">opsForValue</span><span style="color:#C9D1D9;">().</span><span style="color:#D2A8FF;">getAndSet</span><span style="color:#C9D1D9;">(key,value);</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">    /**</span></span>
<span class="line"><span style="color:#8B949E;">     *</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">key</span></span>
<span class="line"><span style="color:#8B949E;">     * </span><span style="color:#FF7B72;">@return</span><span style="color:#8B949E;"> 判断key是否存在</span></span>
<span class="line"><span style="color:#8B949E;">     */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">boolean</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">hasKey</span><span style="color:#C9D1D9;">(String </span><span style="color:#FFA657;">key</span><span style="color:#C9D1D9;">){</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> redisTemplate.</span><span style="color:#D2A8FF;">hasKey</span><span style="color:#C9D1D9;">(key);</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-3886f8ec data-v-4fc1a8f4><div class="edit-info" data-v-4fc1a8f4><div class="edit-link" data-v-4fc1a8f4><a class="VPLink link edit-link-button" href="https://github.com/space2030?tab=repositories" target="_blank" rel="noopener noreferrer" data-v-4fc1a8f4 data-v-8dd034e6><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" data-v-4fc1a8f4><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> 在 github 上编辑此页<!--]--><!----></a></div><div class="last-updated" data-v-4fc1a8f4><p class="VPLastUpdated" data-v-4fc1a8f4 data-v-537b088a>最后更新: <time datatime="2023-10-16T01:45:19.000Z" data-v-537b088a></time></p></div></div><!----></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter" data-v-581d5782 data-v-3d0cd5b8><div class="container" data-v-3d0cd5b8><p class="message" data-v-3d0cd5b8>Released under the MIT License.</p><p class="copyright" data-v-3d0cd5b8>Copyright © 2023-present Evan You</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"index.md\":\"f37252e3\",\"src_case_example_aqs抽象队列同步器.md\":\"24756237\",\"src_case_example_arraylist扩容机制解析.md\":\"a4b8bed3\",\"src_case_example_arrays类sort()方法使用的排序算法.md\":\"ccfbb6ab\",\"src_case_example_concurrenthashmap为什么放弃了分段锁.md\":\"0a4ffee0\",\"src_case_example_es与mysql数据不一致.md\":\"d871661c\",\"src_case_example_redis与mysql数据不一致.md\":\"26418c82\",\"src_case_example_tomcat性能优化.md\":\"dfbb266f\",\"src_case_example_中间件设计.md\":\"468e8da7\",\"src_case_example_代码片段.md\":\"925caa6b\",\"src_case_example_分布式事务解决方案.md\":\"2f070cfb\",\"src_case_example_分布式唯一id.md\":\"23eadd1f\",\"src_case_example_分布式锁-基于数据库的实现.md\":\"4d8b29d2\",\"src_case_example_分库分表.md\":\"c52281c2\",\"src_case_example_如何处理千万级别mysql数据库锁表问题.md\":\"b4c0af50\",\"src_case_example_如何快速从千万级大表删除数据.md\":\"91fe5800\",\"src_case_example_批量处理数据.md\":\"78b0d9bb\",\"src_case_example_接口性能优化.md\":\"9d1792f7\",\"src_case_example_架构设计.md\":\"d307ccb7\",\"src_case_example_百万级别数据导入导出如何优化.md\":\"98a549ab\",\"src_case_example_百万级数据深度分页如何优化.md\":\"32c9674d\",\"src_case_example_秒杀.md\":\"fcad5d18\",\"src_case_example_系统设计规范.md\":\"15c311eb\",\"src_case_example_线上环境踩坑之并行流丢失数据.md\":\"1c3be8f9\",\"src_case_example_线程池.md\":\"e4225766\",\"src_case_example_综合面.md\":\"f493e2fa\",\"src_case_example_网络.md\":\"2753f5be\",\"src_case_example_设计接口.md\":\"38f526c0\",\"src_case_example_设计模式.md\":\"47a4706e\",\"src_case_example_重构.md\":\"f8b1bb82\",\"src_case_index.md\":\"e7293aa9\",\"src_case_norm_javascript规范.md\":\"9fb24129\",\"src_case_norm_java规范.md\":\"538dd69a\",\"src_case_norm_markdown规范.md\":\"2b32c5f2\",\"src_case_norm_vue规范.md\":\"898eb012\",\"src_case_norm_前后端规约.md\":\"e89a40a3\",\"src_case_norm_接口对接规范.md\":\"6d91f32f\",\"src_case_norm_日志规范.md\":\"f59ee845\",\"src_case_redis操作.md\":\"2f51e4c7\",\"src_deploy_index.md\":\"6cb4a725\",\"src_deploy_mongodb部署.md\":\"8a227b4a\",\"src_deploy_mysql部署.md\":\"11af5f81\",\"src_deploy_node部署.md\":\"fdf9e10a\",\"src_deploy_oracle部署.md\":\"f730433a\",\"src_deploy_redis部署.md\":\"ad57b569\",\"src_git_index.md\":\"1f809b9a\",\"src_index_index.md\":\"33da6e30\",\"src_kit_blog.md\":\"1c11ac7e\",\"src_kit_index.md\":\"04dd6794\",\"src_kit_nginx.md\":\"5c165844\",\"src_kit_tool.md\":\"d4ebdde9\",\"src_view_index.md\":\"dc64bfa6\",\"src_view_java_java-01-se.md\":\"d50e6d5e\",\"src_view_java_java-02-ee.md\":\"06cece6f\",\"src_view_java_java-03-tomcat.md\":\"4e071e95\",\"src_view_java_java-04-spring.md\":\"294e3736\",\"src_view_java_java-05-mybatis.md\":\"f08a45bf\",\"src_view_java_java-06-spring-boot.md\":\"0aff5c53\",\"src_view_java_java-07-maven.md\":\"cd8805f9\",\"src_view_java_java-08-spring-cloud.md\":\"9b8482f6\",\"src_view_java_java-09-mysql.md\":\"00f74996\",\"src_view_java_java-10-redis.md\":\"07f078ba\",\"src_view_java_java-11-oracle.md\":\"333de976\",\"src_view_java_java-12-gateway.md\":\"d8b6a793\",\"src_view_java_java-13-elasticsearch.md\":\"b01a920e\",\"src_view_java_java-14-mongodb.md\":\"a29b919f\",\"src_view_java_java-15-rocketmq.md\":\"2983da5e\",\"src_view_java_java-16-activemq.md\":\"d2aa5ffd\",\"src_view_java_java-17-rabbitmq.md\":\"ed854218\",\"src_view_java_java-18-zookeeper.md\":\"2bb8ca84\",\"src_view_java_java-19-kafka.md\":\"ef7bf4c5\",\"src_view_web_web-01-html.md\":\"f76a68db\",\"src_view_web_web-02-javascript.md\":\"560f2ce1\",\"src_view_web_web-03-vue.md\":\"e6cb6cc4\",\"src_web_index.md\":\"4759f761\",\"src_web_vitepress_vitepress快速开始.md\":\"86859a47\",\"src_web_vitepress_vitepress语法规则.md\":\"e4ba6974\",\"src_web_vitepress_vitepress项目发布.md\":\"246085db\"}")</script>
    <script type="module" async src="/vitepress-deploy/assets/app.2a154df8.js"></script>
    
  </body>
</html>